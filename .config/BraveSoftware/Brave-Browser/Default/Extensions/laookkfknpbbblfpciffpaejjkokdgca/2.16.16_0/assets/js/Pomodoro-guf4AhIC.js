import{o,K as t,n as s,z as e,O as i,k as r,u as n,A as a,aF as c,aG as p,m as d,j as u,e as l}from"./icon-alert--q0yLTMi.js";import{u as h,P as f,T as S,p as v}from"./pomodoroCompleted-DWEcdQPX.js";import{f as w,B as g}from"./BaseIcon-B5UifJH3.js";import y from"./focusCollection-DJwEOnFQ.js";import{M as b}from"./MobileBlur-B2s9dLKD.js";import{a as C}from"./allComponentsMounted-C3UsG_cA.js";import{f as j}from"./flashMessageMixin-Bo-_qvLn.js";import{c as x}from"./constants-BT5o8PmI.js";import{T,e as k,D as _}from"./index-DQvfDEB6.js";import{D as P}from"./DashCheckbox-C5KvMjHL.js";import{B as F}from"./BaseDropdown-DBvV1Fy2.js";import{B as D}from"./BaseDropdownOption-umPWLVqy.js";import{g as B}from"./focusFlashMessageHelpers-BehuxQc7.js";import{a as M}from"./reactiveCustomization-DqGARD3C.js";import{a as N,T as I}from"./PomodoroTimers-BWkB-14p.js";import{S as z}from"./SmoothReflow-Du5fECCq.js";import{w as A}from"./loginHelpers-BZASe8UD.js";import{B as O}from"./BaseDropdownDivider-z6WJAu5K.js";import{T as R}from"./ToggleSwitch-DUGISQcW.js";import{a as V}from"./AppHeader-DgK-F-wR.js";import{C as U,c as E,a as q}from"./ClockSwitcher-CMAEFZjA.js";import{m as H}from"./customization-fX3KDebH.js";import{s as $}from"./showAnyway-d_ZUKj8O.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";import"./arrow-Be8MuPJi.js";import"./icon-weather-reset-C06kxk3l.js";import"./icon-settings-Bycjf8-G.js";import"./icon-back-arrow-CiRQJ6G-.js";import"./icon-back-D_TFrgyJ.js";import"./icon-trash-BQ1O-AfY.js";import"./icon-close-BUGl_M7j.js";import"./icon-cog-BFr_Pva7.js";import"./icon-skip-BOkC5L0N.js";import"./icon-down-BiHbKN-t.js";import"./icon-edit-CixeXNYx.js";import"./icon-ellipsis-D3jS4u3x.js";import"./icon-error-state-BKQhfBCj.js";import"./icon-heart-v5O7C6eS.js";import"./icon-hide-NFfBhfBx.js";import"./icon-key-BPNRipb3.js";import"./icon-next-B4hjdiAA.js";import"./icon-photo-BrwqV1T0.js";import"./icon-pin-BHeOuzvO.js";import"./icon-plus-D4YOesIc.js";import"./icon-profile-B_XWyuTb.js";import"./icon-x-qUCmf2CW.js";import"./icon-skip-intro-BUi8b3Ak.js";import"./icon-tooltip-CN09iXOB.js";import"./icon-visible-on-CM3kpcFN.js";import"./icon-x-caret-half-CZtcH_PM.js";import"./tasks-completed-Dg2z75km.js";import"./add-COIuonao.js";import"./google-DKPAcOmk.js";import"./arrow-up-1QPpu78M.js";import"./square-check-DwLT60gj.js";import"./clocks-DjzskNOU.js";import"./close-Bj_A2br_.js";import"./search-DCqlmJx6.js";import"./folder-CwWTWsnJ.js";import"./switch-EuBTQVVE.js";import"./focus-mode-09pIyYAW.js";import"./storage-YYEO5TB5.js";import"./icon-confetti-Dz2LojDe.js";import"./ocean-bubbles-GcKjBI5B.js";import"./sparks-CAw9b6ob.js";import"./secure-B8YP-AML.js";import"./icon-asana-Csd73e1k.js";import"./icon-percent-schedule-CA5EI9b7.js";import"./icon-trello-DhCq-Fsi.js";import"./icon-clean-rFsPxTtp.js";import"./icon-more-lists-Cl9oRGK2.js";import"./icon-more-fonts-CcfOY0t4.js";import"./icon-focus-stats-keERwXFt.js";import"./icon-top-of-mind-B6EhbCcK.js";import"./icon-flow-5QqmGIWX.js";import"./icon-integrations-D9o58ob4.js";import"./icon-weather-extra-ufLpT_SX.js";import"./icon-spiral-gh4hwZDD.js";import"./icon-happy-place-D1z6CJgM.js";import"./icon-time-sensitive-CP2L3maw.js";import"./icon-hourly-CdMmiQZT.js";import"./icon-infinity-D4yMRoAd.js";import"./icon-personalize-photos-D2M4lLlt.js";import"./icon-skip-2bGCAGKt.js";import"./icon-photo-match-C2EChNEK.js";import"./icon-random-375DbcwF.js";import"./icon-timezones-DGZoTtaT.js";import"./icon-simplify-BRUtLJYp.js";import"./icon-sync-DIH26Y9h.js";import"./VueBase-W7f1OYgs.js";import"./index-CJJH83pl.js";import"./portal-vue.esm-SV1wohGy.js";import"./itemModelMixin-B7XBtNZL.js";import"./namesMixin-DfNb5KMg.js";import"./addin-d8CNU_f0.js";import"./style-TaIEnhS-.js";import"./ViewState-_YxhE_TX.js";import"./main-FH8FpKq2.js";import"./handlebarLoader-xbtIzd6B.js";import"./migrateLegacyUserMessageHandler-DMvEmYM4.js";import"./BaseDropdownContent-BSCj37As.js";import"./constants-CALDQiUE.js";import"./index-D7SyL4qE.js";import"./authService-CGVTYYkM.js";import"./AppHeaderControl-FZTURLhY.js";import"./BaseDropdownText-CrjTnGhF.js";const L=o({name:"PomodoroCircle",setup:()=>({pomodoroSessionStore:h()}),computed:{dashProgress(){const o=this.pomodoroSessionStore.totalLength;return Math.min(this.pomodoroSessionStore.timeRemaining,o)/o*212+"%"}}}),W=()=>{t(((o,t)=>({"96c79bac":o.dashProgress})))},G=L.setup;L.setup=G?(o,t)=>(W(),G(o,t)):W;const K=s(L,(function(){var o=this._self._c;return this._self._setupProxy,o("div",{staticClass:"pomodoro-circle",attrs:{"data-test":"pomodoro-circle"}},[o("div",{staticClass:"circle-inner"},[o("div",{staticClass:"circle-background"}),o("div",{staticClass:"circle-foreground"}),o("inline-svg",{staticClass:"circle-svg",attrs:{src:w}})],1)])}),[],!1,null,"eef61666").exports;const J=s(o({name:"PomodoroTimer",props:{hours:{type:Number,required:!0},minutes:{type:String,required:!0},seconds:{type:String,required:!0},hideSeconds:{type:Boolean,required:!0}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-timer",attrs:{"data-test":"timer"}},[o.hideSeconds?t("div",{staticClass:"calm-timer"},[0!==o.hours?t("span",[o._v(o._s(o.hours)+"h ")]):o._e(),o._v(o._s(o.minutes)+"m ")]):t("div",{staticClass:"timer",class:{"has-hours":0!==o.hours,"slim-minutes":0===o.hours&&1===o.minutes.length}},[0!==o.hours?[t("span",{staticClass:"hours",attrs:{"data-test":"hours"}},[o._v(o._s(o.hours))]),t("span",{staticClass:"colon"},[o._v(":")])]:o._e(),t("span",{staticClass:"minutes",attrs:{"data-test":"minutes"}},[o._v(o._s(o.minutes))]),t("span",{staticClass:"colon"},[o._v(":")]),t("span",{staticClass:"seconds",attrs:{"data-test":"seconds"}},[o._v(o._s(o.seconds))])],2)])}),[],!1,null,"789810fc").exports,X=o({name:"PomodoroFocus",components:{ThreeColLayout:T,DashCheckbox:P,BaseDropdown:F,BaseDropdownOption:D,BaseIcon:g},mixins:[C,j],props:{textOverride:{type:String,default:""}},setup:()=>({vMobileBlur:b,debounceSaveFn:()=>{},prompt:e(),fontSizer:e(),hiddenData:e(),dropdown:e()}),data:()=>({fontSizeScale:1,focusText:"",maskVisible:!1}),computed:{inputPlaceholder:()=>"I will focus on...",activeFocus:()=>y.activeFocus,collectionReady:()=>y.loaded,displayedFocus(){return this.textOverride||this.focusText||this.inputPlaceholder},autoFocus:()=>M.autoFocus},watch:{displayedFocus:{handler:"onFocusChange"},"activeFocus.focus"(o){this.focusText!==o&&(this.focusText=o)}},async mounted(){this.debounceSaveFn=i(this.save,1e3),await r((()=>this.collectionReady)).toBe(!0),this.focusText=this.activeFocus.focus,m.on("pomodoro:focusPromptIfFocusEmpty",this.focusPromptIfFocusEmpty),this.onFocusChange()},destroyed(){m.off("pomodoro:focusPromptIfFocusEmpty",this.focusPromptIfFocusEmpty)},methods:{async save(){if(this.activeFocus.focus!==this.focusText){if(!this.focusText.trim().length)return this.archive();this.activeFocus.copyProperties(),y.emptyFocus&&(this.activeFocus.editProps.forDate=n.getDateString()),this.activeFocus.editProps.focus=this.focusText.trim(),await y.save().catch(console.error)}},async onFocusChange(){var o;localStorage.setItem(x,this.focusText||""),await n.doubleRaf();const t=null==(o=this.fontSizer)?void 0:o.clientWidth;this.fontSizeScale=!t||t<=125?1:t>=200?.62:1-(t-125)/75*.38,await n.doubleRaf(),t&&this.prompt&&this.hiddenData&&(this.maskVisible=this.hiddenData.offsetWidth>this.prompt.clientWidth),m.trigger("focus-content:updated")},complete(){y.toggleComplete(),this.activeFocus.completed&&this.showFlashMessage(B())},archive(){var o;y.archive(),this.focusText="",null==(o=this.dropdown)||o.closeDropdown()},toggleAutofocus(){var o;m.commandManager.execute("todo.toggle.autofocus",null,{sourceApp:"Focus",eventSource:"focus"}),null==(o=this.dropdown)||o.closeDropdown()},createNewFocus(){this.archive(),this.focusPrompt()},focusPromptIfFocusEmpty(){this.focusText||this.focusPrompt()},focusPrompt(){var o;null==(o=this.dropdown)||o.closeDropdown(),this.$nextTick((()=>{var o;return null==(o=this.prompt)?void 0:o.focus()}))},blurPrompt(){var o;null==(o=this.prompt)||o.blur()}}}),Q=()=>{t(((o,t)=>({"3ff60ea5":o.fontSizeScale})))},Y=X.setup;X.setup=Y?(o,t)=>(Q(),Y(o,t)):Q;const Z=s(X,(function(){var o,t=this,s=t._self._c;return t._self._setupProxy,s("div",{staticClass:"pomodoro-focus dark",attrs:{"data-test":"focus"}},[s("transition",{attrs:{name:"fade",mode:"out-in"},on:{"after-enter":t.onFocusChange}},[t.collectionReady?s("three-col-layout",{key:null==(o=t.activeFocus)?void 0:o.todoId,staticClass:"focus-grid",scopedSlots:t._u([{key:"left",fn:function(){return[t.focusText&&!t.textOverride?s("dash-checkbox",{attrs:{"data-test":"complete",value:!!t.activeFocus.completed},on:{input:t.complete}}):t._e()]},proxy:!0},{key:"center",fn:function(){return[s("div",{staticClass:"prompt",class:{done:t.activeFocus.completed&&t.focusText&&!t.textOverride},attrs:{"data-test":"focus-active"}},[t.textOverride?s("div",[t._v(t._s(t.textOverride))]):[s("span",{ref:"hiddenData",staticClass:"hidden-data"},[t._v(t._s(t.focusText||t.inputPlaceholder))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.focusText,expression:"focusText"}],ref:"prompt",staticClass:"focus-input",class:{"mask-visible":t.maskVisible},attrs:{type:"text",placeholder:t.inputPlaceholder,"data-test":"focus-input",autocomplete:"off"},domProps:{value:t.focusText},on:{input:[function(o){o.target.composing||(t.focusText=o.target.value)},t.debounceSaveFn],keyup:function(o){return!o.type.indexOf("key")&&t._k(o.keyCode,"enter",13,o.key,"Enter")&&t._k(o.keyCode,"escape",void 0,o.key,void 0)?null:(o.stopPropagation(),t.blurPrompt.apply(null,arguments))}}})]],2)]},proxy:!0},{key:"right",fn:function(){return[t.textOverride?t._e():s("base-dropdown",{ref:"dropdown",attrs:{"data-test":"more-toggle"}},[t.focusText&&!t.activeFocus.completed?s("base-dropdown-option",{attrs:{"data-test":"edit"},on:{click:t.focusPrompt}},[s("base-icon",{attrs:{src:"icon-edit"}}),s("span",{staticClass:"text"},[t._v("Edit")])],1):t._e(),t.focusText?s("base-dropdown-option",{attrs:{"data-test":"clear"},on:{click:t.archive}},[s("div",{staticClass:"smaller-size-icon"},[s("base-icon",{attrs:{src:"icon-close",size:"10px"}})],1),s("span",{staticClass:"text"},[t._v("Clear")])]):t._e(),!t.focusText||t.activeFocus.completed?s("base-dropdown-option",{attrs:{"data-test":"new"},on:{click:t.createNewFocus}},[s("div",{staticClass:"smaller-size-icon"},[s("base-icon",{attrs:{src:"icon-plus",size:"11px"}})],1),s("span",{staticClass:"text"},[t._v("New focus task")])]):t._e(),s("base-dropdown-option",{attrs:{"data-test":"autofocus"},on:{click:t.toggleAutofocus}},[s("div",{staticClass:"smaller-size-icon"},[s("base-icon",{attrs:{src:"icon-play",size:"9px"}})],1),s("span",{staticClass:"text"},[t._v("Turn "+t._s(t.autoFocus?"off":"on")+" Top task in center")])])],1)]},proxy:!0}],null,!1,3429405482)}):t._e()],1),s("div",{staticClass:"fix-height"},[t._v(" ")]),s("div",{ref:"fontSizer",staticClass:"font-sizer"},[t._v(t._s(t.displayedFocus))])],1)}),[],!1,null,"736eab3f").exports;const oo=s(o({name:"PomodoroButtons",components:{SmoothReflow:z,BaseIcon:g},props:{extendFocusVisible:{type:Boolean,required:!0},timeRemaining:{type:Number,required:!0},pomodoroButtonState:{type:Number,required:!0}},setup:()=>({pomodoroSessionStore:h(),TimerId:N}),computed:{mainButtonIcon(){if(this.pomodoroButtonState===f.Play)return"icon/soundscapes-variant";if(this.pomodoroButtonState===f.Pause)return"icon/pause";throw new Error("no icon for button :"+this.pomodoroButtonState)}},mounted(){m.on("globalEvent:spacebar",this.toggleMasterPlayPause)},destroyed(){m.off("globalEvent:spacebar",this.toggleMasterPlayPause)},methods:{resume(){this.pomodoroSessionStore.resume({playSounds:!0})},pause(){this.pomodoroSessionStore.pause({playSounds:!0})},toggleMasterPlayPause(){this.pomodoroSessionStore.playing?this.pause():this.resume()},switchToWithSounds(o){return this.pomodoroSessionStore.switchTo(o,{playSounds:!0})}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-buttons dark"},[t("smooth-reflow",{attrs:{width:!0,height:!1,transition:"smooth-width-fade"}},[o.extendFocusVisible?t("div",{staticClass:"button dash-button u--mobile-hide",attrs:{"data-test":"extend-focus-button"},on:{click:function(t){return o.switchToWithSounds(o.TimerId.FocusPlusTen)}}},[t("span",[o._v("Focus + 10 min")])]):o._e()]),t("div",{staticClass:"button dash-button",attrs:{"data-test":"start-stop-button","data-button-state":o.pomodoroButtonState},on:{click:o.toggleMasterPlayPause}},[t("base-icon",{attrs:{size:"30px",src:o.mainButtonIcon}})],1)],1)}),[],!1,null,"daec56f9").exports;const to=s(o({name:"PomodoroModes",setup:()=>({pomodoroSessionStore:h(),TimerId:N}),methods:{switchToPaused(o){return this.pomodoroSessionStore.switchTo(o,{startPlaying:!1})}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-modes"},[t("div",{staticClass:"mode",class:{active:o.pomodoroSessionStore.anyFocusTimerActive},attrs:{"data-test":"focus-btn"},on:{click:function(t){return o.switchToPaused(o.TimerId.Focus)}}},[o._v("Focus")]),t("div",{staticClass:"mode",class:{active:o.pomodoroSessionStore.anyBreakTimerActive},attrs:{"data-test":"rest-btn"},on:{click:function(t){return o.switchToPaused(o.TimerId.Break)}}},[o._v("Break")])])}),[],!1,null,"0718b773").exports,so=o({name:"InlineNumberInput",props:{value:{type:String,required:!0},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},default:{type:Number,default:1},min:{type:Number,default:0},max:{type:Number,default:9999},debounce:{type:Number,default:0}},emits:["input"],setup:()=>({debounceTimeout:void 0,input:e()}),data(){return{innerValue:this.value}},watch:{value(){this.innerValue=this.value}},methods:{debouncedUpdate(o){let t=o.target.value;if(0===this.debounce)return this.$emit("input",t);this.innerValue=t,clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout((()=>{t=Number(t||this.default).toString(),isNaN(Number(t))?t=this.default.toString():Number(t)<this.min?t=this.min.toString():Number(t)>this.max&&(t=this.max.toString()),this.$emit("input",t)}),this.debounce)},focus(){this.$nextTick((()=>{var o;null==(o=this.input)||o.focus()}))}}});const eo=o({name:"PomodoroDropdown",components:{BaseDropdown:F,BaseDropdownOption:D,BaseIcon:g,BaseDropdownDivider:O,ToggleSwitch:R,InlineNumberInput:s(so,(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"inline-number-input",class:{disabled:o.disabled,readonly:o.readonly}},[t("div",{staticClass:"hidden-data"},[o._v(o._s(o.innerValue))]),t("input",{ref:"input",staticClass:"hide-controls",attrs:{type:"number",disabled:o.disabled,readonly:o.readonly,min:o.min,max:o.max},domProps:{value:o.innerValue},on:{input:o.debouncedUpdate}})])}),[],!1,null,"dd4ed2fe").exports,AppHeader:V,ClockSwitcher:U},setup:()=>({pomodoroSessionStore:h(),clockSwitcher:e(),focusInput:e(),restInput:e(),TimerMode:I}),computed:{focusDuration(){return this.pomodoroSessionStore.pomodoroSettings.focusDuration},restDuration(){return this.pomodoroSessionStore.pomodoroSettings.restDuration},currentMode(){return E[this.pomodoroSessionStore.countUpActive?I.CountUp:I.Timer]},modeOptions(){return k.currentValue?[E[this.pomodoroSessionStore.countUpActive?I.Timer:I.CountUp]]:[E[q.Clock],E[q.Percent]]}},methods:{async onNotificationOptionClick(){var o;this.pomodoroSessionStore.pomodoroSettings.browserNotifications?this.pomodoroSessionStore.saveSettingsToCustomization("browserNotifications",!1):(await this.pomodoroSessionStore.getNotificationsPermissionsToRequest()&&(null==(o=this.clockSwitcher)||o.closeDropdown()),this.pomodoroSessionStore.ensureNotificationPermissions())},openDropdown(){var o;null==(o=this.clockSwitcher)||o.openDropdown()},async switchClockOrMode(o){switch(o){case I.CountUp:case I.Timer:this.pomodoroSessionStore.totalProgress&&await this.pomodoroSessionStore.complete({completedManually:!0,switchToTimer:N.Focus}),H("focusModeSettings",(t=>{t.pomodoroTimerMode=o})),a.capture("pomodoro switch",{feature:"pomodoro",new_value:o});break;case q.Clock:case q.Percent:this.$emit("switchClock",o)}}}});const io=s(o({name:"Pomodoro",components:{PomodoroCircle:K,PomodoroTimer:J,PomodoroFocus:Z,PomodoroButtons:oo,PomodoroModes:to,ThreeColLayout:T,PomodoroDropdown:s(eo,(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-dropdown dark u--mobile-hide",attrs:{"data-test":"pomodoro-dropdown"}},[t("base-dropdown",{ref:"dropdown",attrs:{"min-width":"230px","container-class":"app pomodoro-dropdown-container dash","data-test":"more-toggle"},scopedSlots:o._u([{key:"toastHeader",fn:function(){return[o._t("mobileToast")]},proxy:!0}],null,!0)},[t("app-header",{scopedSlots:o._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{size:"16px",src:o.currentMode.icon||""}}),t("span",{staticClass:"app-header-name"},[o._v(o._s(o.currentMode.label))])]},proxy:!0},{key:"right",fn:function(){return[t("clock-switcher",{attrs:{"mode-options":o.modeOptions},on:{switchTo:o.switchClockOrMode}})]},proxy:!0}])}),o.pomodoroSessionStore.countUpActive?o._e():t("base-dropdown-option",{attrs:{"data-test":"complete-timer"},on:{click:function(t){return o.pomodoroSessionStore.complete({completedManually:!0})}}},[t("base-icon",{staticClass:"dropdown-icon",attrs:{src:"icon/pomodoro/icon-forward",size:"13px"}}),t("span",[o._v("Complete timer")])],1),t("base-dropdown-option",{attrs:{"data-test":"restart-timer"},on:{click:function(t){return o.pomodoroSessionStore.restartTimer()}}},[t("base-icon",{staticClass:"dropdown-icon",attrs:{src:"icon/pomodoro/icon-restart",size:"13px"}}),t("span",[o._v("Restart timer")])],1),o.pomodoroSessionStore.countUpActive?o._e():t("base-dropdown-option",{attrs:{"data-test":"extend-timer"},on:{click:function(t){o.pomodoroSessionStore.saveSettingsToCustomization("focusDuration",Number(o.focusDuration)+10)}}},[t("base-icon",{staticClass:"dropdown-icon",attrs:{src:"icon/pomodoro/icon-plus",size:"13px"}}),t("span",[o._v("Add 10 minutes")])],1),o.pomodoroSessionStore.countUpActive?o._e():[t("base-dropdown-divider"),t("base-dropdown-option",{on:{click:function(t){var s;null==(s=o.focusInput)||s.focus()}}},[t("span",[o._v("Focus")]),t("span",{staticClass:"input-wrapper"},[t("inline-number-input",{ref:"focusInput",attrs:{value:o.focusDuration.toString(),debounce:1e3,min:1,"data-test":"focus-input"},on:{input:t=>o.pomodoroSessionStore.saveSettingsToCustomization("focusDuration",t)}}),t("span",{staticClass:"input-unit"},[o._v("min")])],1)]),t("base-dropdown-option",{on:{click:function(t){var s;null==(s=o.restInput)||s.focus()}}},[t("span",[o._v("Break")]),t("span",{staticClass:"input-wrapper"},[t("inline-number-input",{ref:"restInput",attrs:{value:o.restDuration.toString(),debounce:1e3,min:1,"data-test":"rest-input"},on:{input:t=>o.pomodoroSessionStore.saveSettingsToCustomization("restDuration",t)}}),t("span",{staticClass:"input-unit"},[o._v("min")])],1)]),t("base-dropdown-divider"),t("base-dropdown-option",{attrs:{title:"Play sounds when timers start or end","data-test":"sounds"},on:{click:function(t){return o.pomodoroSessionStore.saveSettingsToCustomization("sounds",!o.pomodoroSessionStore.pomodoroSettings.sounds)}}},[t("span",[o._v("Play sounds")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.sounds}})],1)]),t("base-dropdown-option",{attrs:{title:"Auto-start break timer after completing focus timer","data-test":"auto-play"},on:{click:function(t){return o.pomodoroSessionStore.saveSettingsToCustomization("autoplay",!o.pomodoroSessionStore.pomodoroSettings.autoplay)}}},[t("span",[o._v("Auto-start timers")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.autoplay}})],1)])],t("base-dropdown-option",{attrs:{title:"Hide the seconds count for a calmer timer experience","data-test":"calm-timer"},on:{click:function(t){return o.pomodoroSessionStore.saveSettingsToCustomization("hideSeconds",!o.pomodoroSessionStore.pomodoroSettings.hideSeconds)}}},[t("span",[o._v("Hide seconds")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.hideSeconds}})],1)]),o.pomodoroSessionStore.countUpActive?o._e():t("base-dropdown-option",{attrs:{title:"Get notified outside of your browser when your timer ends","data-test":"os-notifications"},on:{click:o.onNotificationOptionClick}},[t("span",[o._v("Browser notifications")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.browserNotifications}})],1)])],2)],1)}),[],!1,null,"85fb14f3").exports},mixins:[C],props:{inPictureInPicture:{type:Boolean,default:!1}},setup:()=>({pomodoroSessionStore:h(),tabElection:new _("pomodoro"),showAnyway:$,pomodoroDropdown:e(),pomodoroFocus:e(),TimerMode:I}),computed:{extendFocusVisible(){return this.pomodoroSessionStore.activeTimerId===N.Break&&!this.pomodoroSessionStore.playing&&0===this.pomodoroSessionStore.totalProgress&&this.$plus&&!this.pomodoroSessionStore.countUpActive},buttonState(){return this.pomodoroSessionStore.playing?f.Pause:f.Play},documentTitle(){var o;if(!this.pomodoroFocus||!this.pomodoroFocus.collectionReady)return"";const t=null==(o=this.pomodoroFocus)?void 0:o.activeFocus,s=this.pomodoroSessionStore.fullTimeString,e=this.pomodoroSessionStore.anyFocusTimerActive,i=e?"Focus":"Break";return`${s} ${e?"🧑‍💻":"🧘"} · ${t&&t.focus&&!t.completed&&e?t.focus:i}`},timeRemainingForWatcher(){const o=this.pomodoroSessionStore;return o.loaded&&this.tabElection.isLeader.value&&!this.inPictureInPicture?o.timeRemaining:null}},watch:{timeRemainingForWatcher(o,t){if(null===o)return;const s=this.pomodoroSessionStore.pomodoroSettings.autoplay;s&&this.pomodoroSessionStore.playing&&o===S&&t!==S&&this.pomodoroSessionStore.syncPendingNotification(s),this.pomodoroSessionStore.playing&&0===o&&this.pomodoroSessionStore.complete()},documentTitle:{handler(o){document.title=o||"New Tab"},immediate:!0}},async mounted(){await r((()=>this.pomodoroSessionStore.loaded)).toBe(!0),this.emitComponentMounted(),await A(),m.on("newDay",this.onNewDay);const o=c();if("notificationClick"in o&&o.notificationClick in v&&(p("notificationClick"),this.pomodoroSessionStore.onNotificationClick(o.notificationClick)),!d()&&this.browserNotifications){const o=u();"notifications"in o&&o.notifications.create||this.pomodoroSessionStore.ensureNotificationPermissions()}this.inPictureInPicture||l.addCrossTabMessageListener("pomodoro:closed",this.closePomodoro)},destroyed(){var o;null==(o=this.tabElection)||o.stepDown(),document.title="New Tab",m.off("newDay",this.onNewDay),this.inPictureInPicture||(this.pomodoroSessionStore.playing&&this.pomodoroSessionStore.complete({switchAfterComplete:!1,completedManually:!0}),l.removeCrossTabMessageListener("pomodoro:closed",this.closePomodoro),l.sendCrossTabMessage("pomodoro:closed"))},methods:{onAllComponentsMountedOverride(){},switchClock(o){a.capture("clock switch",{feature:"default clock",new_value:o}),M.percentClock=o===q.Percent,this.closePomodoro()},openDropdown(){var o;null==(o=this.pomodoroDropdown)||o.openDropdown()},closePomodoro(){this.$emit("pomodoro-show",!1)},async onNewDay(){await r((()=>this.pomodoroSessionStore.loaded)).toBe(!0),this.pomodoroSessionStore.playing||(this.pomodoroSessionStore.anyFocusTimerActive&&this.pomodoroSessionStore.partialProgress?await this.pomodoroSessionStore.complete({completedManually:!0,switchToTimer:N.Focus}):this.pomodoroSessionStore.anyBreakTimerActive&&this.pomodoroSessionStore.switchTo(N.Focus,{startPlaying:!1}))}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro app-container has-dash-icon",class:{"show-anyway":o.showAnyway.includes("pomodoro")},attrs:{"data-test":"pomodoro","data-show-anyway":"pomodoro"}},[t("transition",{attrs:{mode:"out-in",name:"fade"}},[t("div",{key:o.pomodoroSessionStore.activeTimer.mode,class:["mode-"+o.pomodoroSessionStore.activeTimer.mode.toLowerCase()]},[o.pomodoroSessionStore.activeTimer.mode===o.TimerMode.Timer?t("pomodoro-circle"):o._e(),o.pomodoroSessionStore.activeTimer.mode===o.TimerMode.Timer?t("pomodoro-modes"):o._e(),t("transition",{attrs:{mode:"out-in",name:"fade"}},[o.pomodoroSessionStore.loaded?t("div",{key:o.pomodoroSessionStore.activeTimerId},[t("three-col-layout",{scopedSlots:o._u([{key:"center",fn:function(){return[t("pomodoro-timer",{directives:[{name:"mobile-click",rawName:"v-mobile-click",value:o.openDropdown,expression:"openDropdown"}],attrs:{hours:o.pomodoroSessionStore.hours,minutes:o.pomodoroSessionStore.minutes,seconds:o.pomodoroSessionStore.seconds,"hide-seconds":o.pomodoroSessionStore.pomodoroSettings.hideSeconds}})]},proxy:!0},{key:"right",fn:function(){return[t("pomodoro-dropdown",{ref:"pomodoroDropdown",on:{switchClock:o.switchClock}})]},proxy:!0}],null,!1,3773211242)}),t("pomodoro-focus",{ref:"pomodoroFocus",attrs:{"text-override":o.pomodoroSessionStore.anyBreakTimerActive?"Break Timer":""}}),t("pomodoro-buttons",{attrs:{"time-remaining":o.pomodoroSessionStore.timeRemaining,"pomodoro-button-state":o.buttonState,"extend-focus-visible":o.extendFocusVisible}})],1):o._e()])],1)])],1)}),[],!1,null,"6a611a28").exports;export{io as default};