import{h as e}from"./handlebarLoader-xbtIzd6B.js";e({addin:"9b62165c-8b05-4f9b-82b3-b093f4e77dc9",dependencies:["settings"],commands:["settings.panels.general"],id:"settings_general"},Object.assign({"./commands/panel.js":e=>{e.commands.SettingsPanelGeneral=m.models.Command.extend({defaults:{id:"settings.panels.general"},execute:function(){return e.styleLoaded||(e.styleLoaded=!0,e.styles.style()),new e.views.General}})},"./views/general.js":e=>{var t=e.dependencies.settings;e.views.General=t.views.SettingsPanel.extend({attributes:{id:"settings-general",class:"settings-view settings-general","data-test":"settings-general"},template:e.templates.general,panelid:"general",panelTitle:"General",events:{"click .config-button":"configWidget","click .toggle-option":"toggleOption","click .slide-toggle":"toggleSlider","dblclick .slide-toggle":"eatDblClick","click .balanced-message":"switchToBalanceSettings",webkitAnimationEnd:"onAnimationEnd"},initialize:function(){this.model=m.models.customization,this.initializeCustomizeItems(),this.listenTo(this.model,"change",this.customizationModelChanged),m.Analytics.capture("settings panel show",{feature:"settings",name:"general"})},initializeCustomizeItems:function(){var e=m.models.themeManager.getAvailableFonts(),t=this;this.customizeItems=[{name:"Theme",dataId:"settings-general-theme",field:"themeColour",options:[{label:"Dark",value:"dark"},{label:"Light",value:"light"},{label:"System",value:"system",breakafter:!0},{label:"Photo Match",value:"photo",plusOnly:!0},{label:"",value:"custom",view_opt:{settingName:"themeColour",ignoreClick:!0},plusOnly:!0,show_always:!0,dataTest:"custom"}],default:"system",section:"customize"},{name:"Font",dataId:"settings-general-font",field:"themeFont",options:e,default:"default",plusOnly:!0,requiredFeature:"plus",section:"customize"},{name:"Links",dataId:"settings-general-links",field:"linksVisible",section:"widgets"},{name:"Bookmarks Bar",dataId:"settings-general-bookmarks-bar",field:{name:"bookmarksVisible",get:function(){return m.models.customization.get("bookmarksVisible")},set:function(e){var s=function(e){e||(m.models.bookmarksSettings.set("defaultMostVisited",!1),m.models.bookmarksSettings.optionsChanged()),t.model.save({bookmarksVisible:e})};if(!e)return s(!1);var i=m.models.bookmarksSettings,n={permissions:i.permissions.permissions,origins:i.permissions.origins};t.ensurePermissions(n,s,"Momentum","To display your bookmarks")}},section:"widgets",unsupported:m.utils.bookmarksNotSupported()||m.utils.isTouchDevice()},{name:"Top Sites",dataId:"settings-general-most-visited",field:{name:"mostVisited",get:function(){return m.models.bookmarksSettings.get("defaultMostVisited")},set:function(e){var s=function(e){e&&t.model.save({bookmarksVisible:!0}),m.models.bookmarksSettings.set("defaultMostVisited",e),m.models.bookmarksSettings.optionsChanged(),m.Analytics.capture("start in top sites toggle",{feature:"bookmarks",new_value:e,location:"settings general"})};if(!e)return s(!1);var i={permissions:m.models.bookmarksSettings.permissions.permissions};t.ensurePermissions(i,s,"Momentum","To display your bookmarks")}},skipAnalyticsOnChange:!0,section:"widgets",message:"Show most visited websites by default in Bookmarks Bar",unsupported:m.utils.bookmarksNotSupported()||m.utils.isTouchDevice()},{name:"Search",dataId:"settings-general-search",field:{name:"searchVisible",get:function(){return t.model.get("searchVisible")},set:function(e){var s={searchVisible:e};e&&t.model.get("centerBelowNavVisible")&&(s.focusVisible=!1),e||(s.launchpadVisible=!1),t.model.save(s)}},section:"widgets"},{name:"Weather",dataId:"settings-general-weather",field:"weatherVisible",section:"widgets"},{name:"Clock",eventFeatureName:"default clock",dataId:"settings-general-clock",field:"clockVisible",section:"widgets"},{name:"Greeting",dataId:"settings-general-greeting",field:{name:"greetingVisible",get:function(){return t.model.get("greetingVisible")},set:function(e){var s={greetingVisible:e};!e&&t.model.get("mantraVisible")&&(s.mantraVisible=!1),t.model.set(s)}},section:"widgets"},{name:"Mantras",dataId:"settings-general-mantras",field:{name:"mantraVisible",get:function(){return m.models.customization.get("mantraVisible")},set:function(e){var t={mantraVisible:e};e&&!m.models.customization.get("greetingVisible")&&(t.greetingVisible=!0),m.models.customization.set(t)}},message:"Simple phrases to build positive mental habits",section:"widgets",beta:!1},{name:"Daily Goal",dataId:"settings-general-focus",field:{name:"focusVisible",get:function(){return t.model.get("focusVisible")},set:function(e){var s={focusVisible:e};e&&t.model.get("centerBelowNavVisible")&&(s.searchVisible=!1),t.model.save(s)}},section:"widgets"},{name:"Tasks",dataId:"settings-general-todo",field:"todoVisible",section:"widgets"},{name:"Quotes",dataId:"settings-general-quote",field:"quoteVisible",section:"widgets"},{name:"Countdowns",dataId:"settings-general-countdown",field:"countdownVisible",plusOnly:!0,requiredFeature:"countdown",message:"Count down to important dates and deadlines",section:"widgets"},{name:"Metrics",dataId:"settings-general-metric",field:"metricVisible",plusOnly:!0,requiredFeature:"plus",message:"Keep your important metrics at a glance",section:"widgets"},{name:"Focus Stats",dataId:"settings-focus-mode-insight",field:"focusInsightVisible",section:"widgets",message:"See how many minutes you've focused"},{name:"Notes",dataId:"settings-general-notes",field:"notesVisible",plusOnly:!0,requiredFeature:"notes",message:"Take quick notes and store wisdom to review",section:"widgets"},{name:"World Clocks",dataId:"settings-general-world-clocks",field:"multiClockVisible",plusOnly:!0,requiredFeature:"plus",message:"Keep track of time anywhere on Earth",section:"widgets",beta:!1},{name:"Tab Stash",dataId:"settings-general-tabs",field:"tabsVisible",plusOnly:!0,unsupported:m.utils.isTouchDevice(),requiredFeature:"tab-stash",message:"Stash open tabs for later so you can focus",section:"widgets"},{name:"Soundscapes",dataId:"settings-general-soundscapes",field:"soundscapesVisible",plusOnly:!0,unsupported:m.utils.isTouchDevice(),requiredFeature:"plus",message:"Sounds to help you focus and relax",section:"widgets"},{name:"Focus Mode",dataId:"settings-general-focus-mode",field:"focusModeVisible",unsupported:m.utils.isTouchDevice(),message:"Concentrate by eliminating distractions with timers and sounds.",section:"widgets",requiredFeature:"non-legacy"},{name:"Site Blocker",dataId:"settings-general-site-blocker",field:"siteBlockerVisible",plusOnly:!0,unsupported:m.utils.isTouchDevice(),message:"Block access to distracting websites.",section:"widgets",requiredFeature:"site-blocker"},{name:"Search in Center",dataId:"settings-general-center-below-nav",field:{name:"centerBelowNavVisible",get:function(){return m.models.customization.get("centerBelowNavVisible")},set:function(e){var s={centerBelowNavVisible:e,focusVisible:!e};e&&(s.searchVisible=!0),e||(s.launchpadVisible=!1),t.model.save(s)}},section:"labs",message:"Enable toggling between Search and Daily Goal in the center"},{name:"Launchpad",dataId:"settings-general-launchpad",field:{name:"launchpadVisible",get:function(){return m.models.customization.get("launchpadVisible")},set:function(e){var s=function(e){var s={};e?(s.centerBelowNavVisible=!0,s.launchpadVisible=!0,s.searchVisible=!0,s.focusVisible=!1):s.launchpadVisible=!1,t.model.save(s)};if(!e)return s(!1);var i={permissions:["topSites"]};m.utils.isChrome()&&i.permissions.push("favicon"),t.ensurePermissions(i,s,"Launchpad","To display your top sites")}},section:"labs",message:"Show your top sites under the clock",unsupported:m.utils.bookmarksNotSupported()||m.utils.isTouchDevice()},{name:"Ask AI",dataId:"settings-general-ai",field:"askAiVisible",plusOnly:!0,requiredFeature:"plus",message:"Create, learn and problem-solve directly from your dashboard",section:"labs"}]},render:function(){var e=m.isLoggedIn();this.$el.html(this.template({loggedIn:e})),this.$popBody=this.$(".pop-body");var s={customize:this.$el.find("#customize-list"),widgets:this.$el.find("#apps-list"),misc:this.$el.find("#misc-list"),labs:this.$el.find("#labs-list")};_.each(s,(function(e){e.empty()}));var i=this;return _.each(this.customizeItems,(function(e){var n=Object.assign({},e);("non-legacy"!==n.requiredFeature||i.featureAvailable("non-legacy"))&&(i.fieldHasOwnControl(e.field)&&(n.field=e.field.name),n.options?s[n.section].append(t.templates["general-toggle-options"](n)):s[n.section].append(t.templates["general-toggle-slider"](n)))})),this.updateControlStates(_.pluck(this.customizeItems,"field")),m.commandManager.execute("settings.color.picker",this.$el[0]),this},onAnimationEnd:function(e){m.utils.removePulseClass(e)},customizationModelChanged:function(e){if(e){var t=e.changedAttributes(),s=_.keys(t);this.updateControlStates(s)}},fieldHasOwnControl:function(e){return!("object"!=typeof e||null===e||!e.get||!e.set)},updateControlStates:function(e){var t=this;_.each(e,(function(e){var s=t.findMatchingItem(e);if(s){var i=t.fieldHasOwnControl(e),n=i?e.get():t.model.get(e),a=t.getFieldName(e);if(s.options){s.plusOnly&&!t.featureAvailable(s.requiredFeature)&&(n=s.default),t.$el.find("."+a).removeClass("active"),t.$el.find("."+a+"[data-option-value='"+n+"']").first().addClass("active")}else{var o=i?n:t.model.getComputedSetting(e);n=!(s.plusOnly&&!t.featureAvailable(s.requiredFeature))&&!!n;var l=t.$el.find("[data-related-widget='"+a+"']");if(l&&1===l.length){var r=l.first();if(r.toggleClass("on",n),n!==o){var d=t.model.overrides[e];d===t.model.settingOverriders.TEAM?(r.toggleClass("on",o),r.append('<span class="option-message"> &nbsp; &nbsp;Currently managed by team</span>'),r.addClass("balanced")):d===t.model.settingOverriders.BALANCE&&(r.append('<span class="option-message balanced-message"> &nbsp; &nbsp;Currently hidden by Balance mode (Customize here)</span>'),r.addClass("balanced"))}}}}}))},setOption:function(e){var t=e.attr("data-related-widget"),s=e.attr("data-option-value"),i=this.findMatchingItem(t);if(!i)return null;var n=_.findWhere(i.options,{value:s});if(!(i.plusOnly&&!this.featureAvailable(i.requiredFeature)||n&&n.plusOnly&&!this.isPlus())){m.models.activeBackground.isCustom()&&n&&"photo"===n.value&&n.plusOnly&&this.isPlus(),this.$el.find("."+t).removeClass("active"),e.addClass("active");var a={};return i.boolean?a[i.field]=JSON.parse(s):a[i.field]=s,this.model.save(a),m.Analytics.capture(i.name.toLowerCase()+" select",{feature:"themes",is_paid_event:i.plusOnly||n&&n.plusOnly||!1,new_value:s}),i}m.cmd("modal.open","UPSELL_THEMES",{eventSource:"settings"})},findMatchingItem:function(e){var t=this;return"object"==typeof e&&(e=e.name),this.customizeItems.find((function(s){return(t.fieldHasOwnControl(s.field)?s.field.name:s.field)===e}))},getFieldName:function(e){return this.fieldHasOwnControl(e)?e.name:e},toggleOption:function(e){var t=$(e.delegatedTarget),s=t.attr("data-option-value"),i=this.setOption(t);if(!0!==i){if(i){var n=_.findWhere(i.options,{value:s});if(n&&n.view&&n.view.handleClick){if($(e.target).closest(".sub-view").length>0&&n.view.ignoreClickEvent&&n.view.ignoreClickEvent(e.target))return;if(n.view.handleClick(e,!0),n.view.scrollIntoViewElement){var a=n.view.scrollIntoViewElement();a&&this.scrollIntoView(a)}}}m.trigger("globalEvent:settingsclick",e)}else e.stopImmediatePropagation()},scrollIntoView:function(e){var t=$(e),s=t.closest(".settings-view-container"),i=t.offset().top,n=s.offset().top;i-n-12<0&&s.animate({scrollTop:s[0].scrollTop+i-n-12})},configWidget:function(e){e.stopImmediatePropagation();var t=$(e.delegatedTarget).closest(".slide-toggle").attr("data-related-widget");if(t){var s=this.findMatchingItem(t);m.commandManager.execute(s.configCommand,null,s.configOptions)}},featureAvailable:function(e){return m.conditionalFeatures.featureEnabled(e)||m.conditionalFeatures.featureEnabled(e+"-degraded")},toggleSlider:function(e){if(!this.eatClicks){this.eatClicks=!0;var t,s=this;setTimeout((function(){s.eatClicks=!1}),250);var i=$(".verte");if(!($(e.target).closest("[data-option-value]").length||i.length>0&&$.contains(i[0],e.target)||$(e.delegatedTarget).hasClass("balanced"))){var n=$(e.delegatedTarget).attr("data-related-widget"),a=this.findMatchingItem(n);if(!a.plusOnly||this.featureAvailable(a.requiredFeature)){if(!a.unsupported){var o;if(this.fieldHasOwnControl(a.field))return o=!a.field.get(),a.field.set(o,e),$(e.delegatedTarget).toggleClass("on",o),void u(a);if(n){var l=this.model.get(a.field);if(a.options){var r;for(r=m.conditionalFeatures.featureEnabled("plus")?a.options:a.options.filter((function(e){return!e.plusOnly})),t=0;t<r.length;t++)if(r[t].value===l){t===r.length-1&&(t=-1),o=r[t+1].value;break}var d=$(e.delegatedTarget).find("."+n+"[data-option-value='"+o+"']").first();this.setOption(d)&&e.stopPropagation()}else{if("mantraVisible"===n&&!m.models.mantraSettings.get("firstMantraActivated"))return m.commandManager.executeAsync("settings.display",null,{section:"mantra-settings"}),void u(a);o=!this.model.get(n);var c={};c[n]=o,this.model.save(c),u(a)}}m.trigger("globalEvent:settingsclick",e)}}else"Ask AI"===a.name?m.cmd("modal.open","UPSELL_AI_CHAT",{eventSource:"settings"}):"Countdowns"===a.name?m.cmd("modal.open","UPSELL_COUNTDOWNS",{eventSource:"settings"}):"Metrics"===a.name?m.cmd("modal.open","UPSELL_METRICS",{eventSource:"settings"}):"Notes"===a.name?m.cmd("modal.open","UPSELL_NOTES",{eventSource:"settings"}):"World Clocks"===a.name?m.cmd("modal.open","UPSELL_WORLD_CLOCKS",{eventSource:"settings"}):"Soundscapes"===a.name?m.cmd("modal.open","UPSELL_SOUNDSCAPES",{eventSource:"settings"}):"Tab Stash"===a.name?m.cmd("modal.open","UPSELL_TAB_STASH",{eventSource:"settings"}):"Site Blocker"===a.name?m.cmd("modal.open","UPSELL_SITE_BLOCKER",{eventSource:"settings"}):m.cmd("modal.open","PLUS_GATE",{eventSource:"settings"})}}function u(e){e.skipAnalyticsOnChange||m.Analytics.capture("feature "+(o?"enable":"disable"),{is_paid_event:!!e.plusOnly,feature:e.eventFeatureName||e.name.toLowerCase(),location:"settings general"})}},loginClicked:function(e){e.preventDefault(),e.stopPropagation(),m.commandManager.execute("settings.hide"),m.commandManager.execute("account.login")},logoutClicked:function(e){e.preventDefault(),e.stopPropagation(),$(".action-logout").addClass("action-logout-disabled").text("Logging out..."),m.commandManager.execute("logout")},accountClicked:function(e){e.preventDefault(),e.stopPropagation(),$(e.delegatedTarget).html("Launching..."),$.ajax({type:"POST",data:JSON.stringify({medium:"account"}),url:m.globals.urlRootApi+"login/onetime"}).done((function(e){e&&e.otp&&e.email&&(window.location.href="http://localhost:8995/onetime?email="+encodeURIComponent(e.email)+"&otp="+encodeURIComponent(e.otp))}))},switchToBalanceSettings:function(e){e&&(e.stopPropagation(),e.preventDefault()),m.commandManager.execute("settings.display",null,{section:"balance",showAdvanced:!0})},enableBookmarks:function(e){var t=this;e&&(e.stopPropagation(),e.preventDefault()),m.commandManager.executeAsync("settings.enableBookmarks",{callback:function(){var s=m.models.customization.get("bookmarksVisible"),i=m.models.bookmarksSettings.get("defaultMostVisited");$(e?e.delegatedTarget:'[data-related-widget="bookmarksVisible"]').toggleClass("on",s),t.$('[data-related-widget="mostVisited"]').toggleClass("on",i&&s)}})},isPlus:function(){return m.conditionalFeatures.featureEnabled("plus")},ensurePermissions:function(e,t,s,i){m.promisifiedChrome.permissions.contains(e).then((function(n){n?t(!0):m.cmd("modal.open","PERMISSION_REQUEST",{resolve:t,permissions:e,source:s,reason:i})}))}})}}),Object.assign({"./templates/general.hbs":{compiler:[8,">= 4.3.0"],main:function(e,t,s,i,n){return'<header class="settings-header">\n\t<h3 data-test="general-header">General</h3>\n\t<p class="description">Customize your dashboard</p>\n</header>\n\n\n<h4 class="first">Show</h4>\n<ul id="apps-list" class="settings-list options-list"></ul>\n\n<h4>Labs</h4>\n<ul id="labs-list" class="settings-list options-list"></ul>\n\n<h4>Appearance</h4>\n<ul id="customize-list" class="settings-list options-list"></ul>\n\n\n<section class="u--touch-hide">\n\t<h5>Tip</h5>\n\t<p class="tip">Many items in Momentum can be edited by double-clicking on them, including <strong>your name</strong> and your <strong>tasks</strong>.\n</section>\n'},useData:!0}}),(()=>{}));