import{n as e,ad as t}from"./icon-alert--q0yLTMi.js";import{_ as i}from"./icon-tooltip-CN09iXOB.js";import{S as s}from"./SoftFocus-BUhesXB-.js";import{a}from"./FormToggle-CPdB9uoc.js";const o=e({name:"EditField",directives:{SoftFocus:s},components:{FormToggle:a,Tooltip:e({name:"Tooltip",unreactive:()=>({hoverDurationToActivate:200,defaultMaxWidth:300,minWidth:150}),props:{besideFormLabel:{type:Boolean,default:!1},position:{type:String,default:t.BOTTOM},noMarginBottom:{type:Boolean,default:!1},alignAtBaseline:{type:Boolean,default:!1}},data(){return{open:!1,tooltipWidth:this.defaultMaxWidth,positionOverride:null,openToLeft:!1}},computed:{computedPosition(){return this.positionOverride||this.position}},methods:{mouseEnter(){this.hoverTimeout=setTimeout((()=>{const e=this.$refs["tooltip-wrapper"],i=e.closest(".tooltip-container");if(i){const s=e.getBoundingClientRect(),a=i.getBoundingClientRect(),o=s.left-a.left,r=a.right-s.right,l=this.position===t.LEFT?o:r,n=this.position===t.LEFT?r:o,d=this.defaultMaxWidth>l,p=this.minWidth>l&&n>l;d&&!p?this.tooltipWidth=l:p&&(this.tooltipWidth=Math.min(n,this.defaultMaxWidth),this.position===t.RIGHT?this.positionOverride=t.LEFT:this.openToLeft=!0)}this.open=!0}),this.hoverDurationToActivate)},mouseLeave(){this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.open=!1,this.positionOverride=null,this.openToLeft=!1,this.tooltipWidth=this.defaultMaxWidth}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex-wrapper",class:{"beside-form-label":e.besideFormLabel,"u--no-margin-bottom":e.noMarginBottom,"align-baseline":e.alignAtBaseline}},[e._t("input"),e.$slots["tip-text"]?t("div",{ref:"tooltip-wrapper",staticClass:"tooltip-wrapper"},[t("inline-svg",{staticClass:"tooltip-icon",attrs:{src:i},on:{mouseenter:e.mouseEnter,mouseleave:e.mouseLeave}}),t("transition",{attrs:{name:"fade",duration:"75"}},[e.open?t("div",{staticClass:"tooltip",class:[e.computedPosition,{"open-to-left":e.openToLeft}],style:{"max-width":e.tooltipWidth+"px"}},[e._t("tip-text"),t("div",{staticClass:"notch"})],2):e._e()])],1):e._e()],2)}),[],!1,null,"89c9695a").exports},props:{autoFocus:{type:Boolean,default:!1},viewManager:{type:Object,required:!0},field:{type:Object,required:!0},fieldWarnings:{type:Array,default:()=>[]},componentFieldWarnings:{type:Array,default:()=>[]}},computed:{warning(){return this.fieldWarnings.includes(this.field.property)},editProps(){return this.viewManager.editProps},activeItem(){return this.viewManager.activeItem},computedSelectOptions(){return this.access(this.field.options)},remainingCharacters(){if(this.field.validate&&this.field.validate.maxLength&&"string"==typeof this.editProps[this.field.property])return this.field.validate.maxLength-this.editProps[this.field.property].length},inputWrapperClass(){if(this.field.validate&&this.field.validate.maxLength)return this.remainingCharacters<0?"show-count over-limit":this.remainingCharacters<.6*this.field.validate.maxLength?"show-count close-to-limit":this.remainingCharacters>.8*this.field.validate.maxLength?"hide-count":"show-count"}},watch:{warning(e){if(e){let e=document.activeElement;if(e.classList&&e.classList.contains("error"))return;this.focus()}}},methods:{focus(){this.$refs.element&&this.$refs.element.focus&&this.$refs.element.focus()},blur(){this.$refs.element&&this.$refs.element.blur&&this.$refs.element.blur()},clearWarnings(){this.$emit("clear-warnings")},access:m.utils.access}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"form-row",class:[e.access(e.field.class,e.activeItem),e.warning?"warning":""]},[("input"===e.field.type||"select"===e.field.type)&&e.field.label&&e.access(e.field.tooltip,e.activeItem)?t("tooltip",{attrs:{"beside-form-label":!0}},[t("label",{attrs:{slot:"input",for:e.field.property},slot:"input"},[e._v(e._s(e.field.label))]),t("span",{attrs:{slot:"tip-text"},slot:"tip-text"},[e._v(e._s(e.access(e.field.tooltip,e.activeItem)))])]):"input"!==e.field.type&&"select"!==e.field.type||!e.field.label?e._e():t("label",{attrs:{for:e.field.property}},[e._v(e._s(e.field.label)),e.access(e.field.optionalLabel,e.activeItem)?t("span",{staticClass:"optional"},[e._v("Optional")]):e._e()]),"input"===e.field.type?t("div",{staticClass:"input-wrapper",class:[e.inputWrapperClass,e.field.wrapperClass],attrs:{"data-test":e.field.dataTest+"-input-wrapper"}},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.editProps[e.field.property],expression:"editProps[field.property]",modifiers:{trim:!0}},{name:"soft-focus",rawName:"v-soft-focus",value:e.autoFocus,expression:"autoFocus"}],ref:"element",attrs:{placeholder:e.field.placeholder,name:e.field.property,disabled:e.activeItem.disableEdit||e.access(e.field.disabled,e.activeItem),"data-test":e.field.dataTest+"-input",type:"text",autocapitalize:e.field.autoCapitalize?"on":"off",autocorrect:!1===e.field.autoCorrect?"off":"on",autocomplete:"off"},domProps:{value:e.editProps[e.field.property]},on:{keyup:e.clearWarnings,input:function(t){t.target.composing||e.$set(e.editProps,e.field.property,t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e.field.validate&&e.field.validate.maxLength?t("div",{staticClass:"remaining-characters",attrs:{"data-test":e.field.dataTest+"-remaining-characters"}},[e._v(e._s(e.remainingCharacters))]):e._e()]):"toggle"===e.field.type?t("form-toggle",{ref:"element",staticClass:"in-form",attrs:{name:e.field.property,label:e.field.label,tip:e.field.tip,"data-test":e.field.dataTest+"-input"},model:{value:e.editProps[e.field.property],callback:function(t){e.$set(e.editProps,e.field.property,t)},expression:"editProps[field.property]"}}):"select"===e.field.type?t("div",{staticClass:"select-wrapper"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.editProps[e.field.property],expression:"editProps[field.property]"}],ref:"element",attrs:{name:e.field.property,disabled:e.activeItem.disableEdit||e.access(e.field.disabled,e.activeItem),"data-test":e.field.dataTest+"-input"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.editProps,e.field.property,t.target.multiple?i:i[0])}}},e._l(e.computedSelectOptions,(function(i,s){return t("option",{key:s,attrs:{disabled:i.disabled},domProps:{value:i.value,selected:i.selected}},[e._v(" "+e._s(i.label)+" ")])})),0)]):t(e.field.type,{ref:"element",tag:"component",attrs:{field:e.field,"field-warnings":e.fieldWarnings,"view-manager":e.viewManager,"component-field-warnings":e.componentFieldWarnings,"disable-input":e.activeItem.disableEdit},on:{input:e.clearWarnings},model:{value:e.editProps[e.field.property],callback:function(t){e.$set(e.editProps,e.field.property,t)},expression:"editProps[field.property]"}}),e.field.subText?t("div",{staticClass:"input-description",domProps:{innerHTML:e._s(e.field.subText)}}):e._e()],1)}),[],!1,null,"9a35de09").exports;export{o as E};