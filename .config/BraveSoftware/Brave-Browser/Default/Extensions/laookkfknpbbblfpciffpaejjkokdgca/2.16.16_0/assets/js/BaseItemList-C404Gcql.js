import{B as e,D as t}from"./constants-BpVlFj04.js";import{o as r,n as a,K as d}from"./icon-alert--q0yLTMi.js";import{a as o}from"./allComponentsMounted-C3UsG_cA.js";const s=r({name:"DragDrop",model:{prop:"order",event:"update:order"},props:{order:{type:Array,required:!0},tag:{type:String,default:"div"},useHandles:{type:Boolean,default:!1}},emits:["update:order","drag:start","drag:end"],data:()=>({orderedItems:[],activeOrderedItem:null}),computed:{disabled(){return 0===this.order.length}},watch:{async order(){await this.$nextTick(),this.resetOrder()}},created(){this.resetOrder()},mounted(){this.disabled||this.order.length===this.getFilteredNodes().draggable.length||console.error("DRAG-DROP: The number of slots do not match the number of items provided!")},methods:{setNodesDraggable(e){e.forEach((e=>{var t,r,a,d;e&&!1!==(null==(r=null==(t=e.data)?void 0:t.attrs)?void 0:r.draggable)&&(e.data={...e.data??{},attrs:{...(null==(a=e.data)?void 0:a.attrs)??{},draggable:!0},style:{"-webkit-touch-callout":"none","-webkit-user-select":"none"},on:{...(null==(d=e.data)?void 0:d.on)??{},mousedown:t=>{if(!this.useHandles)return;const r=this.findDraggableHandle(e);r&&r.contains(t.target)&&this.setActiveOrderedItem(e.key)},mouseup:()=>{this.activeOrderedItem=null},dragstart:t=>{var r;this.useHandles&&(null==(r=this.activeOrderedItem)?void 0:r.key)!==e.key?t.preventDefault():t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move",t.dataTransfer.setData("text/plain","arbitrary"),e.elm.style.opacity="0",e.elm.classList.add("dragging"),this.useHandles||this.setActiveOrderedItem(e.key),this.$emit("drag:start"))},dragend:()=>{e.elm.style.opacity="",e.elm.classList.remove("dragging"),this.activeOrderedItem=null,this.$emit("drag:end")},dragover:e=>{e.stopPropagation(),e.preventDefault()},dragenter:()=>{"none"===getComputedStyle(e.elm).transform&&this.activeOrderedItem&&this.activeOrderedItem.key!==e.key&&this.moveOrderedItem(this.activeOrderedItem.key,e.key)},drop:e=>{e.preventDefault();const t=this.orderedItems.map((e=>e.item));this.$emit("update:order",t)}}})}))},findDraggableHandle:e=>e.elm.querySelector("[data-drag-drop-handle]"),getNodes(){var e,t;return(null==(t=(e=this.$scopedSlots).default)?void 0:t.call(e,{}))??[]},getFilteredNodes(){const e={draggable:[],nonDraggable:[]};return this.getNodes().forEach(((t,r)=>{this.isDraggableNode(t)?e.draggable.push(t):e.nonDraggable.push({index:r,node:t})})),e},isDraggableNode(e){var t,r;return!(!this.getNodeTag(e)||!1===(null==(r=null==(t=e.data)?void 0:t.attrs)?void 0:r.draggable))},getNodeKey(e){var t,r;const a=e.key||(null==(r=null==(t=e.asyncMeta)?void 0:t.data)?void 0:r.key);if(!function(e){return["string","number","symbol"].includes(typeof e)}(a))throw new Error('Keys for Drag and Drop items may not be "false"');return a},getNodeTag(e){var t;const r=e.tag||(null==(t=e.asyncMeta)?void 0:t.tag);if("string"!=typeof r&&void 0!==r)throw new Error("tag for node cannot be found");return r},resetOrder(){this.orderedItems=this.getFilteredNodes().draggable.map(((e,t)=>({item:this.order[t],key:this.getNodeKey(e)})))},setActiveOrderedItem(e){this.activeOrderedItem=this.orderedItems.find((t=>t.key===e))??null},moveOrderedItem(e,t){const r=this.orderedItems.findIndex((t=>t.key===e)),a=this.orderedItems.findIndex((e=>e.key===t));if(-1===r||-1===a)return void console.error("Unable to move items, provided keys do not exist within list");const d=[...this.orderedItems],o=d.splice(r,1)[0];o&&(d.splice(a,0,o),this.orderedItems=d)},getOrderedNodes(){if(this.disabled)return this.getNodes();const{draggable:e,nonDraggable:t}=this.getFilteredNodes();this.setNodesDraggable(e);const r=e.reduce(((e,t)=>(e[this.getNodeKey(t)]=t,e)),{}),a=this.orderedItems.map((e=>r[e.key]));return t.length&&t.forEach((({node:e,index:t})=>{a.splice(t,0,e)})),a}},render(e,t){return e("transition-group",{...(null==t?void 0:t.data)??{},props:{...(null==t?void 0:t.data.props)??{},tag:this.tag,name:"drag-drop"},on:{enter:e=>{e.style.transitionDuration="0s"},afterEnter:e=>{e.style.transitionDuration=""},leave:e=>{e.style.transitionDuration="0s"}},nativeOn:{dragleave:({pageX:e,pageY:t})=>{const{left:r,right:a,top:d,bottom:o}=this.$el.getBoundingClientRect();e>r&&e<a&&t>d&&t<o||this.resetOrder()}}},this.getOrderedNodes())}}),n={name:"BaseItemList",components:{DragDrop:s},mixins:[o],model:{prop:"order",event:"update:order"},props:{order:{type:Array,default:()=>[]},direction:{type:String,default:e.Column,validator:t=>Object.values(e).some((e=>e===t))},wrap:{type:Boolean,default:!1},wrapColumnCount:{type:Number,default:t}}},i=()=>{d(((e,t)=>({"0d39c5f6":e.wrapColumnCount})))},l=n.setup;n.setup=l?(e,t)=>(i(),l(e,t)):i;const g=a(n,(function(){var e=this;return(0,e._self._c)("drag-drop",{staticClass:"base-item-list",class:[e.direction,{wrap:e.wrap}],attrs:{tag:"ul",order:e.order},on:{"update:order":function(t){return e.$emit("update:order",t)}}},[e._t("default")],2)}),[],!1,null,"0e6b3c47").exports,u=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{g as B,s as D,u as a};