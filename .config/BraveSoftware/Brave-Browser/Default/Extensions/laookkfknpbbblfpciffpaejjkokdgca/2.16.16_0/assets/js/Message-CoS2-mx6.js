import{M as e}from"./MobileBlur-B2s9dLKD.js";import{a as t}from"./reactiveCustomization-DqGARD3C.js";import{n as a,e as s}from"./icon-alert--q0yLTMi.js";const n=a({name:"Message",directives:{MobileBlur:e},props:{message:{type:Object,default:()=>({})},editingName:{type:Boolean,default:!1}},data(){return{pulse:!1,tempName:this.message.name}},watch:{editingName(e){e&&(this.pulseName(),this.$nextTick((()=>{this.$refs.editingName&&this.$refs.editingName.focus()})))},message(){this.tempName=this.message.name}},methods:{handleNameChange(){const e=this.tempName.trim();e?(t.displayname=e,this.editDone()):this.revertName()},revertName(){this.tempName=t.displayname,this.editDone()},editDone(){this.$emit("editing",!1),this.pulseName(),s.$emit("message:name:edited")},pulseName(){this.pulse=!0,setTimeout((()=>{this.pulse=!1}),1e3)},emitIfEditNameVisible(){this.editingName&&s.$emit("message:name:editing")}}},(function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade",mode:"out-in"},on:{"after-enter":e.emitIfEditNameVisible}},[t("span",{key:e.message.content,staticClass:"content",attrs:{"data-test":"content"}},[t("span",{staticClass:"message",attrs:{"data-test":"message"},on:{dblclick:function(t){return e.$emit("toggle",!0)}}},[e._v(e._s(e.message.content))]),t("span",{staticClass:"name-punctuation-no-wrap"},[e.message.name||e.editingName?t("span",{staticClass:"name-wrapper",attrs:{"data-test":"name-wrapper"}},[e.editingName?t("span",{staticClass:"input-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.tempName,expression:"tempName"},{name:"mobile-blur",rawName:"v-mobile-blur",value:e.handleNameChange,expression:"handleNameChange"}],ref:"editingName",staticClass:"name editing",class:{pulse:e.pulse},attrs:{spellcheck:"false","data-test":"name-input"},domProps:{value:e.tempName},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleNameChange.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.revertName.apply(null,arguments)}],input:function(t){t.target.composing||(e.tempName=t.target.value)}}}),t("span",{staticClass:"name hidden-span"},[e._v(e._s(e.tempName.replace(/ /g," ")||" "))])]):t("span",{staticClass:"name",class:{pulse:e.pulse},attrs:{"data-test":"name"},on:{dblclick:function(t){return e.$emit("editing",!0)}}},[e._v(e._s(e.tempName))])]):e._e(),t("span",{attrs:{"data-test":"punctuation"}},[e._v(e._s(e.message.punctuation))])])])])}),[],!1,null,"06a88c9a").exports;export{n as M};