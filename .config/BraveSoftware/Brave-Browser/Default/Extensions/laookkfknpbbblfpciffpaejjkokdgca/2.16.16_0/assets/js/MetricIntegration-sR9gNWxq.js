import{S as e}from"./SmoothReflow-Du5fECCq.js";import{n as t}from"./icon-alert--q0yLTMi.js";import"./allComponentsMounted-C3UsG_cA.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";const i=t({name:"MetricIntegration",components:{SmoothReflow:e},props:{viewManager:{type:Object,required:!0}},computed:{authNeeded(){return!this.selectedProvider.connected||this.viewManager.activeItem.authNeeded},connectText(){return this.selectedProvider.connected?"Reconnect":"Connect"},editProps(){return this.viewManager.editProps},providers(){return this.viewManager.collection.providers},selectedProviderId:{get(){return this.editProps.providerId},set(e){this.$set(this.editProps,"providerId",e)}},selectedProvider(){return this.providers.items[this.selectedProviderId]},selectedDataPointId:{get(){return this.editProps.providerDataPointId},set(e){this.$set(this.editProps,"providerDataPointId",e)}},selectedDataPoint(){return this.selectedProvider.dataPoints.find((e=>e.id===this.selectedDataPointId))},selectedProviderDataPointOptions(){return this.selectedProvider.dataPoints?this.selectedProvider.dataPoints.map((e=>({value:e.id,label:e.name}))):[]}},watch:{selectedProviderId(e){(e||0===e)&&this.$set(this.editProps,"providerId",e)},selectedDataPointId(e,t){if(e||0===e){let i;this.$set(this.editProps,"providerDataPointId",e),(t||0===t)&&(i=this.selectedProvider.dataPoints.find((e=>e.id===t))),this.editProps.label&&this.editProps.label!==(i&&i.name)||this.$set(this.editProps,"label",this.selectedDataPoint.name)}},"providers.loaded":{handler(e){if(e){const e=this.editProps;e.providerId&&(this.selectedProviderId=e.providerId,this.viewManager.collection.fetchDataPoints(this.selectedProvider)),e.providerDataPointId&&(this.selectedDataPointId=e.providerDataPointId)}},immediate:!0}},methods:{selectProvider(e){this.selectedProviderId=e.id,this.selectedProvider.connected&&this.viewManager.collection.fetchDataPoints(e)},connectProvider(){this.viewManager.collection.connectProvider(this.selectedProvider)}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"metric-integrations"},[t("smooth-reflow",{attrs:{nested:!0,"hide-overflow":!0}},[e.providers.loaded?e.selectedProvider?e.authNeeded?t("div",{key:"3",staticClass:"connect"},[t("label",[e._v(e._s(e.connectText)+" to "+e._s(e.selectedProvider.title))]),t("p",{staticClass:"description"},[e._v("A secure window will open. Momentum doesn't see or access your login info.")]),t("button",{staticClass:"button button-connect",on:{click:e.connectProvider}},[e._v(e._s(e.connectText))])]):e.selectedProvider.connected?t("div",{key:"4"},[t("label",[e._v("Value")]),t("div",{staticClass:"select-wrapper"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedDataPointId,expression:"selectedDataPointId"}],staticClass:"data-points",attrs:{"data-test":"data-points"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedDataPointId=t.target.multiple?i:i[0]}}},[e.selectedProviderDataPointOptions.length?t("option",{attrs:{disabled:""}},[e._v("Select ")]):e._e(),e._l(e.selectedProviderDataPointOptions,(function(i,s){return t("option",{key:s,domProps:{value:i.value}},[e._v(e._s(i.label))])}))],2)])]):e._e():t("div",{key:"2"},[t("ul",{staticClass:"providers tile-list"},e._l(e.providers.items,(function(i,s){return t("li",{key:s,staticClass:"button-list-item provider",on:{click:function(t){return e.selectProvider(i)}}},[t("img",{staticClass:"img",attrs:{src:i.smallIconUrl}}),t("div",{staticClass:"title"},[e._v(e._s(i.title))])])})),0),t("a",{staticClass:"suggest",attrs:{href:"https://suggestions.momentumdash.help/",target:"_blank"}},[e._v("Suggest integration â†’")])]):t("div",{key:"1",staticClass:"loading-wrapper"},[t("i",{staticClass:"loading-icon"})])])],1)}),[],!1,null,"0f88571b").exports;export{i as default};