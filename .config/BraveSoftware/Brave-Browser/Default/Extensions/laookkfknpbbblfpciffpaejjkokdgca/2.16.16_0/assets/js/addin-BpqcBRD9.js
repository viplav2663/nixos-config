import{h as t}from"./handlebarLoader-xbtIzd6B.js";const e={1:function(t,e,s,i,n){var o,a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,c="function",d=t.escapeExpression,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t--\x3e<span class="control control-svg control-heart u--clickable '+d(typeof(o=null!=(o=r(s,"isFavClass")||(null!=e?r(e,"isFavClass"):e))?o:l)===c?o.call(a,{name:"isFavClass",hash:{},data:n,loc:{start:{line:10,column:66},end:{line:10,column:80}}}):o)+'" title="'+d(typeof(o=null!=(o=r(s,"isFavTitle")||(null!=e?r(e,"isFavTitle"):e))?o:l)===c?o.call(a,{name:"isFavTitle",hash:{},data:n,loc:{start:{line:10,column:89},end:{line:10,column:103}}}):o)+'" data-test="button-fav">\n\t\t\t\t<svg class="icon icon-heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 953 1000" data-test="icon-fav"><path d="M1 329q7-115 79-191h2l2-2q88-76 199-76t191 70q32-28 67-45l2-2h2q56-23 117-23 88-2 161 43t110 124v2l2 4q30 106 10 202t-80 175q-62 88-162 172 0 2-2 2-49 45-107 90-34 25-59 41-33 23-55 23l-6 2-5-2q-28-3-59-29-10-6-21-16t-16-13h-2Q125 692 43 540v-2Q-6 444 1 329zm85 1"></path></svg>\n\t\t\t</span>\x3c!--\n'},3:function(t,e,s,i,n){return'\t\t\t--\x3e<span class="control control-edit u--clickable" title="Edit" data-test="button-edit"><i class="icon-edit" data-test="icon-edit"></i></span>\x3c!--\n\t\t\t--\x3e<span class="control control-delete u--clickable" title="Delete" data-test="button-delete">\n\t\t\t\t<i class="icon-trash" data-test="icon-delete">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 24"><path d="M19.15 7.5H2.838a.5.5 0 0 0-.5.5l1.81 14a2 2 0 0 0 2 2h9.954a2 2 0 0 0 2-2L19.65 8a.5.5 0 0 0-.5-.5zm-9.9 13a.75.75 0 0 1-1.5 0v-9a.75.75 0 0 1 1.5 0v9zm5 0a.75.75 0 0 1-1.5 0v-9a.75.75 0 0 1 1.5 0v9zM20.43 4h-4.18a.25.25 0 0 1-.25-.25V2.5A2.5 2.5 0 0 0 13.5 0h-5A2.5 2.5 0 0 0 6 2.5v1.25a.25.25 0 0 1-.25.25h-4.5a1 1 0 0 0 0 2h19.18a1 1 0 0 0 0-2zM8 3.75V2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v1.25a.25.25 0 0 1-.25.25h-5.5A.25.25 0 0 1 8 3.75z" fill-rule="nonzero"/></svg>\n\t\t\t\t</i>\n\t\t\t</span>\x3c!--\n\t\t\t--\x3e<span class="delete-group">\x3c!--\n\t\t\t\t--\x3e<span class="control delete-msg">Delete?</span>\x3c!--\n\t\t\t\t--\x3e<span class="control delete-loading">Deleting...</span>\x3c!--\n\t\t\t\t--\x3e<span class="control delete-failed u--clickable" title="Click to retry">Trouble connecting...</span>\x3c!--\n\t\t\t\t--\x3e<span class="control delete-yes u--clickable" title="Confirm" data-test="button-delete-yes">\n\t\t\t\t\t<i class="icon icon-checkmark">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 577.95 469.42"><polygon points="195.09 469.42 137.44 424.64 140.4 421.42 0 298 46.22 245.43 187.68 369.79 526.33 0 577.95 47.28 229.72 427.53 195.09 469.42"/></svg>\n\t\t\t\t\t</i>\n\t\t\t\t</span>\x3c!--\n\t\t\t\t--\x3e<span class="control delete-no u--clickable" title="Cancel">\n\t\t\t\t\t<i class="icon icon-x">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 47.97 47.97"><path d="M28.23,24,47.09,5.12A3,3,0,0,0,42.85.88L24,19.74,5.12.88A3,3,0,0,0,.88,5.12L19.74,24,.88,42.85a3,3,0,1,0,4.24,4.24L24,28.23,42.85,47.09a3,3,0,0,0,4.24-4.24Z" transform="translate(0 0)"/></svg>\n\t\t\t\t\t</i>\n\t\t\t\t</span>\n\t\t\t</span>\x3c!--\n'},compiler:[8,">= 4.3.0"],main:function(t,e,s,i,n){var o,a,l=null!=e?e:t.nullContext||{},c=t.hooks.helperMissing,d="function",r=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="view">\n\t<div class="cquote">\x3c!--\n\t\t--\x3e<span class="cquote-body" data-test="body"><span class="quote-mark">&ldquo;</span>'+r(typeof(a=null!=(a=u(s,"body")||(null!=e?u(e,"body"):e))?a:c)===d?a.call(l,{name:"body",hash:{},data:n,loc:{start:{line:3,column:87},end:{line:3,column:95}}}):a)+'<span class="quote-mark">&rdquo;</span></span>\x3c!--\n\t\t--\x3e<span class="cquote-source" data-test="source">'+r(typeof(a=null!=(a=u(s,"source")||(null!=e?u(e,"source"):e))?a:c)===d?a.call(l,{name:"source",hash:{},data:n,loc:{start:{line:4,column:52},end:{line:4,column:62}}}):a)+'</span>\n\t</div>\n\n\t<span class="controls">\x3c!--\n\t\t--\x3e<span class="control control-select u--clickable" title="'+r(typeof(a=null!=(a=u(s,"labelSelect")||(null!=e?u(e,"labelSelect"):e))?a:c)===d?a.call(l,{name:"labelSelect",hash:{},data:n,loc:{start:{line:8,column:62},end:{line:8,column:77}}}):a)+'" data-test="button-activate"><i class="icon-check" data-test="icon-activate"></i><i class="loading-icon"></i><i class="error-icon error-select" title="'+r(typeof(a=null!=(a=u(s,"labelSyncError")||(null!=e?u(e,"labelSyncError"):e))?a:c)===d?a.call(l,{name:"labelSyncError",hash:{},data:n,loc:{start:{line:8,column:229},end:{line:8,column:247}}}):a)+'">!</i></span>\x3c!--\n'+(null!=(o=u(s,"if").call(l,null!=e?u(e,"showFavControl"):e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n,loc:{start:{line:9,column:3},end:{line:13,column:9}}}))?o:"")+(null!=(o=u(s,"if").call(l,null!=e?u(e,"onCustomSubnav"):e,{name:"if",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n,loc:{start:{line:14,column:2},end:{line:36,column:9}}}))?o:"")+' \t--\x3e</span>\n</div>\n\n<form class="edit quote-form list-edit-form">\x3c!--\n\t--\x3e<textarea class="list-edit-body textarea-body autoexpand" rows="1" placeholder="Quote" maxlength="'+r(typeof(a=null!=(a=u(s,"inputLengthMaxHtml")||(null!=e?u(e,"inputLengthMaxHtml"):e))?a:c)===d?a.call(l,{name:"inputLengthMaxHtml",hash:{},data:n,loc:{start:{line:41,column:102},end:{line:41,column:124}}}):a)+'" data-test="body-edit">'+r(typeof(a=null!=(a=u(s,"body")||(null!=e?u(e,"body"):e))?a:c)===d?a.call(l,{name:"body",hash:{},data:n,loc:{start:{line:41,column:148},end:{line:41,column:156}}}):a)+'</textarea>\x3c!--\n\t--\x3e<input type="text" class="list-edit-source input input-source" value="'+r(typeof(a=null!=(a=u(s,"source")||(null!=e?u(e,"source"):e))?a:c)===d?a.call(l,{name:"source",hash:{},data:n,loc:{start:{line:42,column:74},end:{line:42,column:84}}}):a)+'" maxlength="'+r(typeof(a=null!=(a=u(s,"inputLengthMaxHtmlSource")||(null!=e?u(e,"inputLengthMaxHtmlSource"):e))?a:c)===d?a.call(l,{name:"inputLengthMaxHtmlSource",hash:{},data:n,loc:{start:{line:42,column:97},end:{line:42,column:125}}}):a)+'" placeholder="Source">\x3c!--\n\t--\x3e<span class="buttons">\x3c!--\n  \t--\x3e<span class="char-count"></span>\x3c!--\n\t\t--\x3e<button class="button submit"><i class="loading-icon"></i><i class="error-icon" title="'+r(typeof(a=null!=(a=u(s,"labelSyncError")||(null!=e?u(e,"labelSyncError"):e))?a:c)===d?a.call(l,{name:"labelSyncError",hash:{},data:n,loc:{start:{line:45,column:92},end:{line:45,column:110}}}):a)+'">!</i>Save</button>\x3c!--\n    --\x3e<button class="cancel u--clickable">Cancel</button>\x3c!--\n\t--\x3e</span>\n</form>\n'},useData:!0},s={1:function(t,e,s,i,n){return'<span class="badge badge-plus">Plus</span>'},compiler:[8,">= 4.3.0"],main:function(t,e,s,i,n){var o,a,l=null!=e?e:t.nullContext||{},c=t.hooks.helperMissing,d="function",r=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\x3c!-- Header --\x3e\n\n<div class="subpanel-header">\n\t<span class="button-advanced" data-test="button-settings">Settings<i class="icon icon-angle-down"></i></span>\n\t<h3>'+r(typeof(a=null!=(a=u(s,"title")||(null!=e?u(e,"title"):e))?a:c)===d?a.call(l,{name:"title",hash:{},data:n,loc:{start:{line:5,column:5},end:{line:5,column:14}}}):a)+'</h3>\n\t<p class="description">'+r(typeof(a=null!=(a=u(s,"description")||(null!=e?u(e,"description"):e))?a:c)===d?a.call(l,{name:"description",hash:{},data:n,loc:{start:{line:6,column:24},end:{line:6,column:39}}}):a)+'</p>\n</div>\n\n\n\x3c!-- Feeds --\x3e\n\n<div class="smooth-height-wrapper">\n\t<div class="smooth-height-content">\n\t\t<div class="wrapper-advanced">\n\t\t\t<h4>Feeds</h4>\n\t\t\t<ul class="settings-list">\n\t\t\t\t<li class="slide-toggle has-toggle '+r(typeof(a=null!=(a=u(s,"feedMomentumClass")||(null!=e?u(e,"feedMomentumClass"):e))?a:c)===d?a.call(l,{name:"feedMomentumClass",hash:{},data:n,loc:{start:{line:17,column:39},end:{line:17,column:60}}}):a)+'" id="feed-momentum-slider">\n\t\t\t\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t\t\t\t<span class="setting-name">Momentum Quotes</span>\n\t\t\t\t\t<span class="option-message">See a daily quote from our curated feed</span>\n\t\t\t\t</li>\n\t\t\t\t<li class="slide-toggle has-toggle '+r(typeof(a=null!=(a=u(s,"feedCustomClass")||(null!=e?u(e,"feedCustomClass"):e))?a:c)===d?a.call(l,{name:"feedCustomClass",hash:{},data:n,loc:{start:{line:22,column:39},end:{line:22,column:58}}}):a)+'" id="feed-custom-slider" data-test="feed-custom-slider">\n\t\t\t\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t\t\t\t<span class="setting-name">'+r(typeof(a=null!=(a=u(s,"labelCustom")||(null!=e?u(e,"labelCustom"):e))?a:c)===d?a.call(l,{name:"labelCustom",hash:{},data:n,loc:{start:{line:24,column:32},end:{line:24,column:47}}}):a)+'</span>\n\t\t\t\t\t<span class="badge badge-plus">PLUS</span>\n\t\t\t\t\t<span class="option-message">Add your own quotes and change the quote anytime</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n\n\n\x3c!-- Subnav + add button --\x3e\n\n<nav class="settings-subnav">\n\t<div class="subnav-titles">\n\t\t<h4 class="custom" data-test="subnav-custom">'+r(typeof(a=null!=(a=u(s,"labelCustom")||(null!=e?u(e,"labelCustom"):e))?a:c)===d?a.call(l,{name:"labelCustom",hash:{},data:n,loc:{start:{line:38,column:47},end:{line:38,column:62}}}):a)+'</h4>\x3c!--\n\t\t--\x3e<h4 class="favorites" data-test="subnav-favs">Favorites</h4>\x3c!--\n\t\t--\x3e<h4 class="history" data-test="subnav-history">History</h4>\n\t</div>\n\t<button class="button list-add-button" data-test="button-add">+ Add<span class="u--mobile-hide"> Quote\n\t\t\t'+(null!=(o=u(s,"unless").call(l,null!=e?u(e,"isPlus"):e,{name:"unless",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n,loc:{start:{line:43,column:3},end:{line:43,column:74}}}))?o:"")+'</span>\n\t</button>\n</nav>\n<div class="settings-subnav-placeholder"></div>\n\n\n\x3c!-- Add form + lists --\x3e\n\n<div class="list-wrapper has-subnav">\n\t<form class="quote-form list-add-form">\x3c!--\n\t\t--\x3e<textarea class="list-add-body textarea-body autoexpand" rows="1" placeholder="Quote" maxlength="'+r(typeof(a=null!=(a=u(s,"inputLengthMaxHtml")||(null!=e?u(e,"inputLengthMaxHtml"):e))?a:c)===d?a.call(l,{name:"inputLengthMaxHtml",hash:{},data:n,loc:{start:{line:53,column:102},end:{line:53,column:124}}}):a)+'" data-test="textarea-body"></textarea>\x3c!--\n\t\t--\x3e<input type="text" class="list-add-source input input-source" maxlength="'+r(typeof(a=null!=(a=u(s,"inputLengthMaxHtmlSource")||(null!=e?u(e,"inputLengthMaxHtmlSource"):e))?a:c)===d?a.call(l,{name:"inputLengthMaxHtmlSource",hash:{},data:n,loc:{start:{line:54,column:78},end:{line:54,column:106}}}):a)+'" placeholder="Source" data-test="input-source">\x3c!--\n\t\t--\x3e<span class="buttons">\x3c!--\n    \t--\x3e<span class="char-count"></span>\x3c!--\n      \t--\x3e<button class="button submit" data-test="button-submit"><i class="loading-icon"></i><i class="error-icon" title="'+r(typeof(a=null!=(a=u(s,"labelSyncError")||(null!=e?u(e,"labelSyncError"):e))?a:c)===d?a.call(l,{name:"labelSyncError",hash:{},data:n,loc:{start:{line:57,column:123},end:{line:57,column:141}}}):a)+'">!</i>Add</button>\x3c!--\n        --\x3e<button class="cancel u--clickable">Cancel</button>\n\t\t\t</span>\n\t</form>\n\n\t<div class="list-body list-body-custom"></div>\n\t<div class="list-body list-body-favorites"></div>\n\t<div class="list-body list-body-history"></div>\n</div>\n'},useData:!0};t({addin:"dd106f35-669c-4079-a9e3-82ddc5244d0b",id:"settings_quotes",dependencies:["settings"],commands:["settings.panels.quotes"]},Object.assign({"./collections/quotes.js":t=>{t.collect.Quotes=Backbone.Collection.extend({initialize:function(){this.model=t.models.Quote,this.listenTo(this,"reset",this.onReset)},onReset:function(){this.loadedOnce=!0},comparator:function(t,e){var s=this.sortAttribute||"sort_order",i=t.get(s),n=e.get(s);return i==n?0:i<n?this.reverse_sort?1:-1:i>n?this.reverse_sort?-1:1:void 0}})},"./models/quote.js":t=>{t.models.Quote=Backbone.Model.extend({defaults:function(){return{body:"New Quote",source:"Unknown",display_date:m.date()}},save:function(t,e){(e=e||{}).patch=!0,Backbone.Model.prototype.save.call(this,t,e)},setActive:function(t,e){var s=m.globals.urlRootApi+"settings/quote/active",i={},n=this.get("_id")||this.get("id");this.get("is_custom")?i.custom_quote_id=n:i.quote_id=n,$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(i),url:s}).done((function(s){s&&s.success?(m.trigger("sync:download","quote"),t(this)):e(this)})).fail((function(){e(this)}))}})},"./models/quoteSettingsManager.js":t=>{t.models.QuoteSettingsManager=Backbone.Model.extend({feedCustomName:"quote-feed-custom",feedMomentumName:"quote-feed-momentum",panelTitle:"Quote Settings",labelCustom:"My Quotes",newModels:[],analytics:new m.Analytics({feature:"quotes",is_paid_event:!0}),initialize:function(){this.plusUser=m.conditionalFeatures.featureEnabled("plus"),this.settings=new m.models.GenericSettings("quote"),this.CustomQuotes(),this.listenTo(m,"quote:favorite",this.onQuoteFavorited),this.listenTo(m,"quote:active_changed",this.onActiveQuoteChanged)},onQuoteFavorited:function(t){if(this.favorites){var e=this.favorites.get(t.id);e?(e.set({is_favorite:t.is_favorite,last_updated:m.date().toISOString()}),this.favorites.sort()):this.favorites.fetch()}if(this.history){var s=this.history.findWhere({_id:t.id});s?(s.set({is_favorite:t.is_favorite,last_updated:m.date().toISOString()}),this.history.sort()):this.history.fetch()}},onActiveQuoteChanged:function(t){if(this.lastActiveQuote!==t&&this.history){var e=this.history.at(0);if(e&&e.get("_id")!==t){var s=this.history.findWhere({_id:t});if(!s&&this.collection&&(s=this.collection.findWhere({id:t})),!s&&this.favorites&&(s=this.favorites.findWhere({id:t})),s){var i=s.clone();i.has("_id")||i.set("id",t),i.set("sort_order",i.get("sort_order")+"-"+m.now()),i.prepend=!0,this.history.add(i),this.history.sort(),this.lastActiveQuote=t}}}},CustomQuotes:function(){return this.collection||(this.collection=new t.collect.Quotes,this.collection.url=m.globals.urlRoot+"settings/quote/quotes",this.listenTo(this.collection,"remove",this.onCollectionRemove),this.listenTo(this.collection,"user-change",this.onCollectionUserChange)),this.collection},customEmpty:function(){return 0===this.collection.length},Favorites:function(){return this.favorites||(this.favorites=new t.collect.Quotes,this.favorites.url=m.globals.urlRoot+"quotes/favorites",this.favorites.sortAttribute="last_updated",this.favorites.reverse_sort=!1),this.favorites},History:function(){var e=this;return this.history||(this.history=new t.collect.Quotes,this.history.url=m.globals.urlRoot+"quotes/history",this.history.reverse_sort=!0,this.history.load_more=m.utils.getDateString(),this.history.parse=function(t){return e.history.load_more=t.load_more,t.history}),this.history},LoadMoreHistory:function(){this.history.load_more&&this.history.fetch({remove:!1,data:{priorToDate:this.history.load_more}})},onCollectionRemove:function(){m.trigger("sync:download","quote"),this.customEmpty()&&this.collection.trigger("user-change"),this.history&&(this.history.loadedOnce=!1),this.favorites&&(this.favorites.loadedOnce=!1)},toggleFavorite:function(t,e){var s=m.globals.urlRootApi+"quotes/favorites",i=t.get("_id")||t.get("id"),n=!t.get("is_favorite"),o=t.get("is_custom"),a={operation:"favorite",active_uuid:i,is_favorite:n,is_custom:o};try{$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(a),url:s}).done((function(e){e&&e.success&&(t.set({is_favorite:n}),m.trigger("sync:download","quote"),m.trigger("quote:favorite",{id:a.active_uuid,is_favorite:a.is_favorite}))})).fail((function(){e&&e()}))}catch(l){m.commandManager.execute("notification.show.enhanced","Connection error."),e&&e()}},toggleFeedMomentum:function(){this.plusUser&&(this.settings.toggle(this.feedMomentumName),this.analytics.capture("quote feed toggle",{feed:"momentum",new_value:this.settings.get(this.feedMomentumName)}))},toggleFeedCustom:function(){this.plusUser?(this.settings.toggle(this.feedCustomName),this.analytics.capture("quote feed toggle",{feed:"custom",new_value:this.settings.get(this.feedCustomName)})):this.showPlusUpsellNotif()},showPlusUpsellNotif:function(){m.cmd("modal.open","UPSELL_QUOTES",{eventSource:"settings"})},onCollectionUserChange:function(){var t=this.settings.get(this.feedCustomName),e=this.customEmpty();e||t||this.toggleFeedCustom(),e&&t&&this.toggleFeedCustom()}})},"./views/custom.js":t=>{t.views.Custom=Backbone.View.extend({template:t.templates.custom,events:{"click .empty-add-shortcut":"handleEmptyAddShortcutClick"},initialize:function(e){this.main=e.main,this.subViews=[],m.quoteSettingsManager||(m.quoteSettingsManager=new t.models.QuoteSettingsManager),this.manager=m.quoteSettingsManager,this.collection=this.manager.CustomQuotes(),this.listenTo(this.collection,"reset",this.addAll),this.listenTo(this.collection,"add",this.onCollectionAdd),this.listenTo(this.collection,"update",this.handleCollectionUpdate),this.listenTo(this.manager,"toggle-add-form",this.handleToggleAddForm)},render:function(){return this.$el.html(this.template()),this.main.setSubnavViewVars(this),this.main.expiredPlusUser||this.main.plusUser?this.collection.loadedOnce?this.addAll():this.collection.fetch({reset:!0}):this.$empty.removeClass("loading"),this},addAll:function(){m.settingsUtils.subnavAddAll(this,!1,this.$quoteList,this.main.syncActiveItem.bind(this.main))},addOne:function(e,s){var i=new t.views.CustomQuote({model:e,main:this.main,subnav:"custom"});m.settingsUtils.subnavAddOne(this,i,this.$quoteList,!0,s)},onCollectionAdd:function(t){this.addOne(t,!0),this.collection.trigger("user-change"),m.Analytics.capture("quote add",{feature:"quotes",is_paid_event:!0})},handleCollectionUpdate:function(){m.settingsUtils.handleCollectionUpdateCustom(this.main,this.$empty,this.manager.customEmpty())},handleToggleAddForm:function(){this.manager.customEmpty()&&!this.main.deletingFinalItem&&this.$empty.mToggle("block",this.main.$addForm.is(":visible"))},handleEmptyAddShortcutClick:function(){this.main.handleClickAddButton()}})},"./views/favorites.js":t=>{t.views.Favorites=Backbone.View.extend({template:t.templates.favorites,initialize:function(e){this.main=e.main,this.subViews=[],m.quoteSettingsManager||(m.quoteSettingsManager=new t.models.QuoteSettingsManager),this.collection=m.quoteSettingsManager.Favorites(),this.listenTo(this.collection,"reset sync",this.addAll),this.listenTo(this.collection,"add",this.onCollectionAdd),this.listenTo(this.collection,"update",this.handleCollectionUpdate)},render:function(){return this.$el.html(this.template()),this.main.setSubnavViewVars(this),this.collection.loadedOnce?this.addAll():this.collection.fetch({reset:!0}),this},addAll:function(){m.settingsUtils.subnavAddAll(this,!1,this.$quoteList,this.main.syncActiveItem.bind(this.main))},addOne:function(e){if(e.get("is_favorite")){var s=new t.views.CustomQuote({model:e,main:this.main,subnav:"favorites"});m.settingsUtils.subnavAddOne(this,s,this.$quoteList,!0,!1)}},onCollectionAdd:function(t){this.addOne(t)},handleCollectionUpdate:function(){m.settingsUtils.updateEmptyState(this)}})},"./views/history.js":t=>{t.views.History=Backbone.View.extend({template:t.templates.history,events:{"click .load-more-button":"loadMore"},initialize:function(e){this.main=e.main,this.subViews=[],m.quoteSettingsManager||(m.quoteSettingsManager=new t.models.QuoteSettingsManager),this.collection=m.quoteSettingsManager.History(),this.listenTo(this.collection,"reset sync",this.addAll),this.listenTo(this.collection,"add",this.onCollectionAdd),this.listenTo(this.collection,"update",this.handleCollectionUpdate)},render:function(){return this.$el.html(this.template()),this.main.setSubnavViewVars(this),this.collection.loadedOnce?this.addAll():this.collection.fetch({reset:!0}),this},addAll:function(){m.settingsUtils.subnavAddAll(this,!1,this.$quoteList,this.main.syncActiveItem.bind(this.main),m.settingsUtils.subnavHistoryUpdateLoadMore.bind(this))},addOne:function(e){var s=new t.views.CustomQuote({model:e,main:this.main,subnav:"history"});m.settingsUtils.subnavAddOne(this,s,this.$quoteList,e.prepend,!1)},onCollectionAdd:function(t){this.addOne(t)},handleCollectionUpdate:function(){m.settingsUtils.updateEmptyState(this),this.main.syncActiveItem()},loadMore:function(t){m.settingsUtils.subnavHistoryLoadMore(t,this,m.quoteSettingsManager)}})},"./views/item.js":t=>{t.views.CustomQuote=Backbone.View.extend({attributes:{class:"content-item quote-item","data-test":"item"},tagName:"li",template:t.templates.item,analytics:new m.Analytics({feature:"quotes",is_paid_event:!0}),events:{"click .control-select":"handleClickSetActive","click .control-heart":"handleClickFavorite","click .control-edit":"handleClickEdit","click .control-delete":"toggleDeleteConf","click .delete-yes":"deleteItem","click .delete-no":"toggleDeleteConf","click .delete-failed":"deleteItem","keyup .list-edit-form":"handleKeyupEsc","keypress .list-edit-form":"handleKeypressEnter","click .submit":"processEditForm","click .cancel":"handleClickCancel"},initialize:function(t){this.main=t.main,this.subnav=t.subnav,this.manager=this.main.manager,this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",m.settingsUtils.onDestroyModel),this.listenTo(this.manager,"item-editing",m.settingsUtils.preventMultipleEdits),this.listenTo(this.manager,"toggle-add-form",m.settingsUtils.returnToViewMode)},render:function(){this.isFavorite=this.model.get("is_favorite"),this.quoteId=this.model.get("_id")||this.model.id,this.isCustom=this.model.get("is_custom");var t={body:this.model.get("body"),source:this.model.get("source")||this.model.defaults.source,labelSelect:this.main.labelSelect,showFavControl:"favorites"===this.subnav||"history"===this.subnav,isFavClass:this.isFavorite?"active":"",isFavTitle:this.isFavorite?"Unfavorite":"Favorite",onCustomSubnav:"custom"===this.subnav,labelSyncError:this.main.labelSyncError,inputLengthMaxHtml:this.main.inputLengthMaxHtml,inputLengthMaxHtmlSource:this.main.inputLengthMaxHtmlSource};return this.$el.html(this.template(t)),this.setViewVars(),this.$el.attr("data-quote-id",this.quoteId),this.updateTooltip(),this},setViewVars:function(){this.$deleteGroup=this.$(".delete-group"),this.$listEditForm=this.$(".list-edit-form"),this.$listEditBody=this.$(".list-edit-body"),this.$listEditSource=this.$(".list-edit-source")},updateTooltip:function(){this.$el.attr("title",this.$el.hasClass("editing")?"":m.utils.getFriendlyDate(this.model.get("display_date")))},handleClickSetActive:function(){this.main.plusUser?(this.setQuoteActive(),this.analytics.capture("quote set active",{custom:this.isCustom})):this.manager.showPlusUpsellNotif()},setQuoteActive:function(){var t=this;m.models.quoteManager.setActiveInProgress||this.$el.hasClass("selected")||(this.setActiveInProgress=!0,m.models.quoteManager.setActiveInProgress=!0,this.$el.removeClass("failed").addClass("loading"),this.model.setActive((function(){t.$el.removeClass("loading"),t.setActiveInProgress=!1,m.models.quoteManager.setActiveInProgress=!1,t.model.get("is_custom")&&t.main.collection.trigger("user-change")}),(function(){t.$el.removeClass("loading").addClass("failed"),t.setActiveInProgress=!1,m.models.quoteManager.setActiveInProgress=!1})))},handleClickFavorite:function(){m.quoteSettingsManager.toggleFavorite(this.model),this.analytics.capture("quote "+(this.model.get("is_favorite")?"unfav":"fav"),{is_paid_event:!1,custom:this.isCustom,location:"settings"})},handleClickEdit:function(){this.$listEditForm.removeClass("loading failed"),m.settingsUtils.changeToEditMode(this,this.$listEditBody),this.updateTooltip()},toggleDeleteConf:function(){m.settingsUtils.toggleDeleteConf(this)},deleteItem:function(){var t=this;this.$deleteGroup.hasClass("loading")||(this.$deleteGroup.removeClass("failed").addClass("loading"),this.model.destroy({wait:!0,success:function(){t.$deleteGroup.removeClass("loading")},error:function(){t.$deleteGroup.removeClass("loading").addClass("failed")}}),this.analytics.capture("quote delete"))},handleKeypressEnter:function(t){m.settingsUtils.handleKeypressEnter(t,this.processEditForm.bind(this))},handleKeyupEsc:function(t){m.settingsUtils.handleKeyupEsc(t,this.abortEdit.bind(this))},processEditForm:function(t){this.main.processForm(t,this.$listEditForm,this.updateItem.bind(this))},updateItem:function(t,e){var s=this;this.model.save(t,{wait:!0,success:function(){e.removeClass("loading"),m.trigger("sync:download","quote"),m.settingsUtils.getOutOfEditMode(s),s.main.collection.trigger("user-change")},error:function(){e.removeClass("loading").addClass("failed")}}),this.analytics.capture("quote edit")},handleClickCancel:function(t){t.preventDefault(),this.abortEdit()},abortEdit:function(){this.$listEditBody.val(this.model.get("body")),this.$listEditSource.val(this.model.get("source")),m.settingsUtils.getOutOfEditMode(this)},destroy:function(){this.remove(),this.unbind()}})},"./views/main.js":t=>{var e=t.dependencies.settings;t.views.Main=e.views.SettingsPanel.extend({attributes:{id:"settings-quotes",class:"settings-view settings-content settings-quotes settings-online","data-test":"settings-quotes"},deletingFinalItem:!1,inputLengthMaxDatabase:250,inputLengthMaxHtml:260,inputLengthMaxHtmlSource:100,inputLengthShow:50,inputLengthWarn:100,itemEditingId:null,labelDeselect:"(Already Active)",labelSelect:"Set Active",labelSyncError:"Trouble connecting… Click to retry",panelid:"quotes",subnav:void 0,template:t.templates.main,events:{"click .button-advanced":"toggleAdvanced","click #feed-custom-slider":"toggleFeedCustom","click #feed-momentum-slider":"toggleFeedMomentum","click .list-add-button":"handleClickAddButton","keyup .list-add-form":"handleKeyupEsc","keypress .list-add-form":"handleKeypressEnter","click .list-add-form .submit":"processAddForm","click .list-add-form .cancel":"cancelAdd","focus .textarea-body":"updateCharCount","input .textarea-body":"updateCharCount","focus textarea.autoexpand":"textareaAutoexpandInitial","input textarea.autoexpand":"textareaAutoexpandLive","click .subnav-titles .custom":"selectCustom","click .subnav-titles .favorites":"selectFavorites","click .subnav-titles .history":"selectHistory"},initialize:function(e){e&&(this.subnav=e.subnav),m.quoteSettingsManager||(m.quoteSettingsManager=new t.models.QuoteSettingsManager),this.manager=m.quoteSettingsManager,this.plusUser=m.conditionalFeatures.featureEnabled("custom-quote"),this.expiredPlusUser=m.conditionalFeatures.featureEnabled("custom-quote-degraded"),this.settings=this.manager.settings,this.listenTo(this.settings,"change",this.updateSettings),this.listenTo(this.settings,"change:allocation_changed",this.allocationChanged),this.listenTo(m,"quote:downloaded",this.syncActiveItem),this.plusUser&&this.settings.fetch(),(this.expiredPlusUser||this.plusUser)&&(this.collection=this.manager.CustomQuotes()),m.Analytics.capture("settings panel show",{feature:"quotes"})},render:function(){var t={description:"A daily reminder for inspiration and growth",inputLengthMaxHtml:this.inputLengthMaxHtml,inputLengthMaxHtmlSource:this.inputLengthMaxHtmlSource,labelCustom:this.manager.labelCustom,labelSyncError:this.labelSyncError,isPlus:this.plusUser,title:"Quotes"};return this.$el.html(this.template($.extend(t,m.settingsUtils.getInitialFeedSettings(this.manager)))),this.setViewVars(),this.plusUser?this.renderCustom():(this.$feedMomentumSlider.addClass("fixed"),this.renderHistory()),this},setViewVars:function(){m.settingsUtils.setFeedVars(this),this.$addButton=this.$(".list-add-button"),this.$addForm=this.$(".list-add-form"),this.$addBody=this.$(".list-add-body"),this.$addSource=this.$(".list-add-source"),this.$customList=this.$(".list-body-custom"),this.$favoritesList=this.$(".list-body-favorites"),this.$historyList=this.$(".list-body-history")},setSubnavViewVars:function(t){t.$empty=t.$(".settings-empty"),t.$quoteList=t.$(".quote-list")},selectCustom:function(t){this.selectSubnav("custom",t,this.renderCustom.bind(this))},selectFavorites:function(t){this.selectSubnav("favorites",t,this.renderFavorites.bind(this))},selectHistory:function(t){this.selectSubnav("history",t,this.renderHistory.bind(this))},selectSubnav:function(t,e,s){e.stopPropagation(),this.subnav!==t?(this.hideAddForm(),this.resetAdd(),s()):m.utils.toggleClassTwice($(e.delegatedTarget),"active")},renderCustom:function(){this.customView||(this.customView=new t.views.Custom({el:this.$customList,main:this})),m.settingsUtils.renderSubnav(this,this.customView,"custom")},renderFavorites:function(){this.favoritesView||(this.favoritesView=new t.views.Favorites({el:this.$favoritesList,main:this})),m.settingsUtils.renderSubnav(this,this.favoritesView,"favorites")},renderHistory:function(){this.historyView||(this.historyView=new t.views.History({el:this.$historyList,main:this})),m.settingsUtils.renderSubnav(this,this.historyView,"history")},updateSettings:function(){m.settingsUtils.updateFeedSettings(this)},allocationChanged:function(){this.settings.has("allocation_changed")&&m.trigger("sync:download","quote")},syncActiveItem:function(){if(m.models.customization.get("quoteVisible")){var t=m.models.quoteManager.getActiveItem().get("_id");this.syncActiveItemHelper(this.$customList,t),this.syncActiveItemHelper(this.$favoritesList,t),this.syncActiveItemHelper(this.$historyList,t)}},syncActiveItemHelper:function(t,e){t.find(".quote-item.selected").removeClass("selected").find(".control-select").attr("title",this.labelSelect),t.find('[data-quote-id="'+e+'"]').first().addClass("selected").find(".control-select").attr("title",this.labelDeselect)},toggleAdvanced:function(){m.settingsUtils.toggleAdvanced(this)},toggleFeedMomentum:function(t){t.stopPropagation(),this.manager.toggleFeedMomentum()},toggleFeedCustom:function(t){t.stopPropagation(),this.manager.toggleFeedCustom()},handleClickAddButton:function(){this.plusUser?this.toggleAddForm():this.manager.showPlusUpsellNotif()},toggleAddForm:function(){"custom"!==this.subnav&&this.renderCustom(),this.manager.trigger("toggle-add-form"),this.$addForm.is(":visible")?this.hideAddForm():(this.$addButton.hide(),this.$addForm.css("display","block"),this.$addBody.trigger("focus"))},hideAddForm:function(){this.$addButton.css("display","block"),this.$addForm.hide()},resetAdd:function(t){this.$addBody.val(""),this.$addSource.val(""),t||this.$addBody.trigger("focus"),this.$addForm.removeClass("loading failed")},handleKeypressEnter:function(t){m.settingsUtils.handleKeypressEnter(t,this.processAddForm.bind(this))},handleKeyupEsc:function(t){m.settingsUtils.handleKeyupEsc(t,this.cancelAdd.bind(this))},processAddForm:function(t){this.processForm(t,this.$addForm,this.createItem.bind(this))},createItem:function(t,e){var s=this;this.collection.create(t,{wait:!0,success:function(){s.resetAdd(!1)},error:function(){e.removeClass("loading").addClass("failed")}})},cancelAdd:function(t){m.settingsUtils.cancelAddGeneral(this,t)},updateCharCount:function(t){m.settingsUtils.updateCharCount(t,this,this.updateSubmitButton.bind(this),$(t.delegatedTarget.form).find(".textarea-body"))},updateSubmitButton:function(t,e,s){var i=0===e||s<0;t.find(".submit").prop("disabled",i).toggleClass("disabled",i)},processForm:function(t,e,s){if(t&&t.preventDefault(),!e.find(".submit").prop("disabled")&&!e.hasClass("loading")){var i=e.hasClass("list-edit-form"),n=this.validateForm(e,i),o={body:n.body,source:n.source};n.valid&&(e.removeClass("failed").addClass("loading"),s(o,e))}},validateForm:function(t,e){var s=t.find(".textarea-body"),i=t.find(".input-source"),n=e?this.removeQuotationMarks(s.val().trim()):this.ensureEndsInPeriod(this.removeQuotationMarks(s.val().trim()));return{valid:!!n,body:n,source:i.val().trim()}},removeQuotationMarks:function(t){var e=[34,39,8216,8217,8220,8221];return _.contains(e,t.charCodeAt(0))&&(t=t.slice(1)),_.contains(e,t.charCodeAt(t.length-1))&&(t=t.slice(0,-1)),t},ensureEndsInPeriod:function(t){return!!t&&(m.utils.endsWithEndPunctuation(t)||(t+="."),t)},textareaAutoexpandInitial:function(t){var e=t.delegatedTarget,s=e.value;e.value="",e.rows=1,e.baseScrollHeight=e.scrollHeight;var i=getComputedStyle(e);e.baseContentHeight=e.baseScrollHeight-parseInt(i.paddingTop,10)-parseInt(i.paddingBottom,10),e.value=s,this.textareaAutoexpandLive(t)},textareaAutoexpandLive:function(t){var e,s=t.delegatedTarget;s.rows=1,e=Math.ceil((s.scrollHeight-s.baseScrollHeight)/s.baseContentHeight),s.rows=1+e}})}}),Object.assign({"./templates/custom.hbs":{compiler:[8,">= 4.3.0"],main:function(t,e,s,i,n){return'<div class="settings-empty loading" data-test="subnav-custom-empty">\n\t<p class="settings-empty-loading"><i class="loading-icon"></i>Loading...</p>\n\t<p class="settings-empty-title empty-add-shortcut">Power up your day with your favorite quotes</p>\n\t<p class="settings-empty-description empty-add-shortcut">Click + Add Quote to get started</p>\n</div>\n\n<ul class="settings-list quote-list hidden" data-test="custom-list"></ul>\n'},useData:!0},"./templates/favorites.hbs":{compiler:[8,">= 4.3.0"],main:function(t,e,s,i,n){return'<div class="settings-empty loading" data-test="subnav-favs-empty">\n\t<p class="settings-empty-loading"><i class="loading-icon"></i>Loading...</p>\n\t<p class="settings-empty-title">No favorite quotes yet</p>\n\t<p class="settings-empty-description">Click the heart icon under a quote to start your collection</p>\n</div>\n\n<ul class="settings-list quote-list hidden" data-test="favs-list"></ul>\n'},useData:!0},"./templates/history.hbs":{compiler:[8,">= 4.3.0"],main:function(t,e,s,i,n){return'<div class="settings-empty loading">\n\t<p class="settings-empty-loading"><i class="loading-icon"></i>Loading...</p>\n\t<p class="settings-empty-title">No quote history yet</p>\n\t<p class="settings-empty-description">Your past quotes will appear here</p>\n</div>\n\n<ul class="settings-list quote-list hidden" data-test="history-list"></ul>\n<div class="load-more">\n\t<span class="button load-more-button">Load More</span>\n</div>\n'},useData:!0},"./templates/item.hbs":e,"./templates/main.hbs":s}),(t=>{m.commandManager&&m.commandManager.registerCommand("settings.panels.quotes",(function(e){return new t.views.Main(e)})),t.styles.style(),m.trigger("settings:register:nav",{id:"quote-settings",title:"Quotes",cmd:"settings.panels.quotes",position:35})}));