const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/countdownCollection-Bk1rYuSE.js","assets/js/preload-helper-DmNsytk6.js","assets/js/VueBase-W7f1OYgs.js","assets/js/icon-alert--q0yLTMi.js","assets/js/localStorage-4iHdj-SC.js","assets/js/string-GDe0WbEj.js","assets/js/index-DQvfDEB6.js","assets/js/migrateLegacyUserMessageHandler-DMvEmYM4.js","assets/js/main-FH8FpKq2.js","assets/css/index-C0DDMXTO.css","assets/js/index-CJJH83pl.js","assets/js/portal-vue.esm-SV1wohGy.js","assets/js/itemModelMixin-B7XBtNZL.js","assets/js/reactiveCustomization-DqGARD3C.js","assets/js/namesMixin-DfNb5KMg.js","assets/js/itemDataServiceMixins-DPsPiv13.js","assets/js/metricMetadata-D4pZaGht.js","assets/js/clocks-DjzskNOU.js","assets/js/captureMixin-D0enqjOF.js","assets/js/metricCollection-JKwIPpBA.js","assets/js/clockCollection-DnrQ1vUl.js","assets/js/focusCollection-DJwEOnFQ.js","assets/js/addin-d8CNU_f0.js","assets/js/style-TaIEnhS-.js","assets/js/ViewState-_YxhE_TX.js","assets/css/style-CebYLhf0.css","assets/js/handlebarLoader-xbtIzd6B.js","assets/js/linksViewState-M45gi0JR.js","assets/js/links-hR2TwzXn.js","assets/js/compareObjects-BF7sSNEf.js","assets/js/tabsViewState-BvLr9Xin.js","assets/js/tabs-BMhS6WRr.js","assets/js/focusModeViewState-BpbRF0A0.js","assets/js/scenes-D8jpYIdj.js","assets/js/ocean-bubbles-GcKjBI5B.js","assets/js/PomodoroTimers-BWkB-14p.js","assets/js/pomodoroCompleted-DWEcdQPX.js","assets/js/loginHelpers-BZASe8UD.js","assets/js/authService-CGVTYYkM.js","assets/js/customization-fX3KDebH.js","assets/js/siteBlockerGroups-E8GFJ9Dm.js","assets/js/constants-BT5o8PmI.js","assets/js/siteBlockerSession-DPf8kIYl.js","assets/js/soundscapesState-BbS4i45E.js"])))=>i.map(i=>d[i]);
import{k as e,u as t,e as s,w as a,M as o,d as i,ag as n}from"./icon-alert--q0yLTMi.js";import{A as l,S as c,p as r,e as d,M as u,C as p,V as f,B as b}from"./index-DQvfDEB6.js";import{b as g,p as _}from"./reactiveCustomization-DqGARD3C.js";import{_ as w}from"./preload-helper-DmNsytk6.js";import{scenes as h}from"./scenes-D8jpYIdj.js";import{a as V}from"./PomodoroTimers-BWkB-14p.js";const y={countdowns:()=>S(w((()=>import("./countdownCollection-Bk1rYuSE.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),metrics:()=>S(w((()=>import("./metricCollection-JKwIPpBA.js").then((e=>e.b))),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,11,15,12,13,14,16,17,18]))),clocks:()=>S(w((()=>import("./clockCollection-DnrQ1vUl.js")),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11,15,12,13,14,16,17,18]))),focus:()=>S(w((()=>import("./focusCollection-DJwEOnFQ.js")),__vite__mapDeps([21,2,3,4,1,5,6,7,8,9,10,11,12,13,14,22,23,24,25,26]))),linksViewStateStore:()=>S(w((()=>import("./linksViewState-M45gi0JR.js")),__vite__mapDeps([27,24,3,4,1,5,8,6,7,9]))),linksStore:()=>S(w((()=>import("./links-hR2TwzXn.js").then((e=>e.l))),__vite__mapDeps([28,3,4,1,5,6,7,8,9,29]))),tabsViewStateStore:()=>S(w((()=>import("./tabsViewState-BvLr9Xin.js")),__vite__mapDeps([30,24,3,4,1,5,8]))),tabsStore:()=>S(w((()=>import("./tabs-BMhS6WRr.js").then((e=>e.t))),__vite__mapDeps([31,3,4,1,5]))),focusModeViewStateStore:()=>S(w((()=>import("./focusModeViewState-BpbRF0A0.js")),__vite__mapDeps([32,3,4,1,5,24,8,6,7,9,13,2,10,11,33,34,35]))),focusModeSessionStore:()=>S(w((()=>Promise.resolve().then((()=>T))),void 0))};async function S(e){return(await e).default}const E=()=>{localStorage.setItem(c,Date.now().toString())},A={pomodoro:{enable:async()=>{m.trigger("centerBelow:show",!1);const s=(await w((async()=>{const{default:e}=await import("./pomodoroCompleted-DWEcdQPX.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([36,3,4,1,5,6,7,8,9,35,13,2,10,11,37,38,39]))).default();return await e((()=>s.loaded)).toBe(!0),s.playing||await s.switchTo(V.Focus,{playSounds:!0}),t.delay(l).then((async()=>{m.trigger("pomodoro:focusPromptIfFocusEmpty"),await t.delay(l),m.trigger("pomodoro:focusPromptIfFocusEmpty")})),!0},disable:async()=>{const t=(await w((async()=>{const{default:e}=await import("./pomodoroCompleted-DWEcdQPX.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([36,3,4,1,5,6,7,8,9,35,13,2,10,11,37,38,39]))).default();await e((()=>t.loaded)).toBe(!0),await t.complete({switchAfterComplete:!1,completedManually:!0})}},siteBlocker:{enable:async()=>{const e=(await w((async()=>{const{default:e}=await import("./siteBlockerGroups-E8GFJ9Dm.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([40,3,4,1,5,41,29]))).default(),t=(await w((async()=>{const{default:e}=await import("./siteBlockerGroups-E8GFJ9Dm.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([40,3,4,1,5,41,29]))).default();e.refresh(),t.refresh();return(await w((async()=>{const{default:e}=await import("./siteBlockerSession-DPf8kIYl.js");return{default:e}}),__vite__mapDeps([42,3,4,1,5,6,7,8,9,40,41,29,32,24,13,2,10,11,33,34,35,36,37,38,39]))).default().active},disable:async({enableResult:e,focusing:t})=>{if(t)return;(await w((async()=>{const{default:e}=await import("./siteBlockerSession-DPf8kIYl.js");return{default:e}}),__vite__mapDeps([42,3,4,1,5,6,7,8,9,40,41,29,32,24,13,2,10,11,33,34,35,36,37,38,39]))).default().toggleActive(!!e)},shouldEnableOnResume:()=>!0,shouldRemoveDataOnSettingsChangeWhileFocusing:!1},soundscapes:{enable:async e=>{var a,o;"soundscapesIsReady"in m.widgetManager&&m.widgetManager.soundscapesIsReady||await new Promise((e=>{m.once("soundscapes:created",e)}));const i=(await w((async()=>{const{default:e}=await import("./soundscapesState-BbS4i45E.js");return{default:e}}),__vite__mapDeps([43,2,3,4,1,5,6,7,8,9,10,11]))).default;s.sendCrossTabMessage("soundscapes:stop"),m.trigger("soundscapes:stop"),m.trigger("soundscapes:togglePopup",!1);let n=null==(o=null==(a=g.focusModeSettings.apps)?void 0:a.soundscapes)?void 0:o.preset;return n&&"Random"!==n||(n=e&&"string"==typeof e?e:t.getRandomItem(h.filter((e=>!["Random","Custom","Noise","Binaural"].includes(e.name)))).name),m.trigger("soundscapes:play",n),i.globalPlaying||(i.globalPlaying=!0),addEventListener("beforeunload",E),n},disable:()=>{m.trigger("soundscapes:stop"),s.sendCrossTabMessage("soundscapes:stop"),removeEventListener("beforeunload",E),localStorage.removeItem(c)},shouldEnableOnResume:()=>{const e=Number(localStorage.getItem(c));return localStorage.removeItem(c),!!(e&&!isNaN(e)&&e>Date.now()-3e4)},shouldDisableEnableOnSettingChangeWhileFocusing:!0},tabStash:{enable:()=>{},disable:async({enableResult:e,inactive:s})=>{var o;if(s)return;const i=(await y.tabsStore())();if(i.loaded&&!i.loading||(await new Promise((e=>{a((()=>i.loaded),e),i.loading||i.refresh()})),await t.delay(1e3)),m.conditionalFeatures.featureEnabled("plus")||m.conditionalFeatures.featureEnabled("tab-stash-degraded")||(e=null==(o=i.getItems[0])?void 0:o.id),"string"==typeof e){const t=i.getItemById(e);t&&await i.restoreSession(t)}},get unsupported(){return t.isSafari()||t.isPwa()}}},I=["siteBlocker","soundscapes","tabStash"];let v;const M=r((({loadedRef:e,updateAsync:s})=>i("focusModeSession",{state:()=>({start:1,stop:1,appActivationData:{},capacityLimitInfo:{msUsed:0,date:t.getDateOnly(new Date)},lastInteraction:Date.now(),totalTimeFocused:0}),getters:{focusModeActive:e=>!e.stop,loaded:()=>e.value,capacityLimitInfoForToday(){const e=this.capacityLimitInfo,s=m.models.date.get("date"),a=t.getDateOnly(s);return e.date!==a?{date:a,msUsed:0}:e},msUntilOverCapacityLimit(){const e=p,t=this.capacityLimitInfoForToday.msUsed,s=m.models.date.get("seconds").getTime();return e-(t+(this.focusModeActive?s-this.start:0))},isOverCapacityLimit(){return this.msUntilOverCapacityLimit<=0},shouldAutoDisable(){const e=m.models.date.get("date").getTime();return this.focusModeActive&&this.lastInteraction<e-u},totalTimeFocusedIncludingCurrentSession(){const e=m.models.date.get("date").getTime();let t=this.totalTimeFocused;return this.focusModeActive&&(t+=e-this.start),Math.max(t,0)}},actions:{async update(e){await s(e)},async stopAndSaveFocusMode(){const e=this.capacityLimitInfoForToday,t=Date.now(),s=t-this.start;e.msUsed+=s;const a=this.totalTimeFocused+s;await this.update({stop:t,capacityLimitInfo:e,totalTimeFocused:a,appActivationData:{}}),this.refreshLastInteraction({debounceTime:0})},async startAndSaveFocusMode(e){const t=this.capacityLimitInfoForToday;await this.update({start:Date.now(),stop:null,appActivationData:e,capacityLimitInfo:t}),this.refreshLastInteraction({debounceTime:0})},refreshLastInteraction({debounceTime:e=3e3}){this.focusModeActive&&(clearTimeout(v),v=window.setTimeout((()=>{this.update({lastInteraction:Date.now()})}),e))},async disableAppsBeforeStop(e){for(const t of I){const s=A[t];s.unsupported||await s.disable({enableResult:this.appActivationData[t],inactive:e})}}}})),{mode:o.Cache,syncAutomatically:!0});(async()=>{const t=M();await e((()=>t.loaded)).toBe(!0),d.switchOverToWatchedStoreItem((()=>t.focusModeActive))})();const T=Object.freeze(Object.defineProperty({__proto__:null,default:M,useFocusModeSessionStore:M},Symbol.toStringTag,{value:"Module"})),D=()=>{const e=g.focusModeSettings,t=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr);return e.apps={...t.apps,...e.apps},{...t,...e}},L=()=>_,O=async(e,t,s)=>{const a=L().focusModeSettings;a.apps[e]||(a.apps[e]={enabled:!1}),a.apps[e][t]=s,L().focusModeSettings=a,M().focusModeActive&&(await(async(e,t)=>{const s=M(),a=s.appActivationData||{};if(t){const t=await A[e].enable();if(null==t)return;a[e]=t}else await A[e].disable({enableResult:a[e],focusing:!0}),(A[e].shouldRemoveDataOnSettingsChangeWhileFocusing??1)&&delete a[e];await s.update({appActivationData:a})})(e,s),R())},R=()=>{const e=D(),t={notesVisible:e.notesVisible,todoVisible:e.todoVisible,quoteVisible:!1,siteBlockerVisible:e.apps.siteBlocker.enabled,soundscapesVisible:e.apps.soundscapes.enabled,tabsVisible:e.apps.tabStash.enabled,focusVisible:!0,centerBelowNavVisible:e.searchVisible,searchVisible:!1,launchpadVisible:!1,focusModeVisible:!0,askAiVisible:e.askAiVisible,linksVisible:e.linksVisible,metricVisible:e.metricsVisible,countdownVisible:e.countdownsVisible,multiClockVisible:e.worldClocksVisible,focusInsightVisible:e.focusInsightVisible,weatherVisible:!1};n(t)},P=()=>{m.widgetManager.addVueAppExemption(f,"focusMode"),m.widgetManager.addAppExemption(b,"focusMode")},k=()=>{m.widgetManager.hideApps({layer:"focusMode"}),m.widgetManager.removeVueAppExemption(f,"focusMode"),m.widgetManager.removeAppExemption(b,"focusMode")},j=()=>{n({soundscapesVisible:!!m.conditionalFeatures.featureEnabled("plus")&&null,tabsVisible:!(!m.conditionalFeatures.featureEnabled("tab-stash-degraded")&&!m.conditionalFeatures.featureEnabled("plus"))&&null,notesVisible:null,todoVisible:null,quoteVisible:null,siteBlockerVisible:null,focusVisible:null,centerBelowNavVisible:null,searchVisible:null,launchpadVisible:null,focusModeVisible:null,askAiVisible:null,linksVisible:null,metricVisible:null,countdownVisible:null,multiClockVisible:null,focusInsightVisible:null,weatherVisible:null})},F=async()=>{if(d.currentValue){const e=(await y.focusModeSessionStore())();await e.disableAppsBeforeStop(!1),await e.stopAndSaveFocusMode()}};export{P as a,j as b,A as c,L as d,O as e,F as f,D as g,T as h,y as i,k as r,R as s,M as u};