import{V as i}from"./ValueWithRandom-DLbdL1Ci.js";import{s as e,o as t,k as n,n as o,l as a}from"./FlashMessage-DPJrdJ6u.js";import"./AnimationOptions-Bi5HrRx1.js";import"./icon-alert--q0yLTMi.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";import"./globalKeyEventManager-Bi-yHy9P.js";import"./icon-close-BUGl_M7j.js";class s extends i{constructor(){super(),this.sync=!1}load(i){i&&(super.load(i),void 0!==i.sync&&(this.sync=i.sync))}}class r extends i{constructor(){super(),this.sync=!1}load(i){i&&(super.load(i),void 0!==i.sync&&(this.sync=i.sync))}}class l{constructor(){this.count=0,this.delay=new s,this.duration=new r}load(i){i&&(void 0!==i.count&&(this.count=i.count),this.delay.load(i.delay),this.duration.load(i.duration))}}class d{constructor(i){this.container=i}init(i){const e=this.container,t=i.options.life;t&&(i.life={delay:e.retina.reduceFactor?n(t.delay.value)*(t.delay.sync?1:a())/e.retina.reduceFactor*o:0,delayTime:0,duration:e.retina.reduceFactor?n(t.duration.value)*(t.duration.sync?1:a())/e.retina.reduceFactor*o:0,time:0,count:t.count},i.life.duration<=0&&(i.life.duration=-1),i.life.count<=0&&(i.life.count=-1),i.life&&(i.spawning=i.life.delay>0))}isEnabled(i){return!i.destroyed}loadOptions(i,...e){i.life||(i.life=new l);for(const t of e)i.life.load(null==t?void 0:t.life)}update(i,a){this.isEnabled(i)&&i.life&&function(i,a,s){if(!i.life)return;const r=i.life;let l=!1;if(i.spawning){if(r.delayTime+=a.value,!(r.delayTime>=i.life.delay))return;l=!0,i.spawning=!1,r.delayTime=0,r.time=0}if(-1===r.duration)return;if(i.spawning)return;if(l?r.time=0:r.time+=a.value,r.time<r.duration)return;if(r.time=0,i.life.count>0&&i.life.count--,0===i.life.count)return void i.destroy();const d=e(0,s.width),c=e(0,s.width);i.position.x=t(d),i.position.y=t(c),i.spawning=!0,r.delayTime=0,r.time=0,i.reset();const u=i.options.life;u&&(r.delay=n(u.delay.value)*o,r.duration=n(u.duration.value)*o)}(i,a,this.container.canvas.size)}}export{d as LifeUpdater};