import{n as t}from"./icon-alert--q0yLTMi.js";import{v as e}from"./viewTransitionHooksMixin-CPPAEiBl.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";const r=t({name:"ItemList",components:{ItemsEmpty:t({name:"ItemsEmpty",props:{viewManager:{type:Object,required:!0},emptyMessage:{type:String,default:""},addLabel:{type:String,default:""}},computed:{addMessage(){const t=this.viewManager.collection.nameLCS;return`Add ${t&&m.utils.isVowel(t[0])?"an":"a"} ${t} to get started`}},methods:{onAdd(){this.viewManager.showView("add")}}},(function(){var t=this,e=t._self._c;return e("section",{staticClass:"empty"},[t._m(0),e("div",{staticClass:"content"},[e("div",{staticClass:"title"},[t._v(t._s(t.emptyMessage))]),e("div",{staticClass:"description"},[t._v(t._s(t.addMessage))]),e("button",{staticClass:"button",attrs:{"data-test":"add-button"},on:{click:t.onAdd}},[t._v(t._s(t.addLabel))])])])}),[function(){var t=this._self._c;return t("ul",{staticClass:"list"},[t("li",{staticClass:"list-row"}),t("li",{staticClass:"list-row"}),t("li",{staticClass:"list-row"})])}],!1,null,"ff6e10f3").exports},store:["teamInfo"],mixins:[e],props:{addLabelOverride:{type:String,default:""},hasCategories:{type:Boolean,default:!1},addButtonText:{type:String,default:"Add"},itemComponent:{type:[Object,Function],default:null},allowReorder:{type:Boolean,default:!1},separatePinned:{type:Boolean,default:!1},filter:{type:Object,default:null}},data:()=>({defaultError:"",dragging:!1,dragstartIndex:null,dragstartKey:null,dragstartModel:null,reorderableItems:[]}),computed:{collection(){return this.viewManager.collection},sort(){return this.collection.sort||((t,e)=>t.order-e.order)},fields(){return this.collection.fields},addLabel(){return this.addLabelOverride||`+ ${this.addButtonText} ${this.collection.nameCS}`},allItems:function(){return this.collection.data.items},filteredItems(){let t=Object.values(this.allItems);return this.filter&&(t=t.filter(this.filter.func)),t.sort(this.sort),t},loaded(){return this.collection.data.loaded},separatorIndices(){let t={};return this.separatePinned&&Object.keys(this.reorderableItems).forEach((e=>{t[e]=this.reorderableItems[e].findIndex((t=>t.separator))})),t},pinning(){return this.dragging&&!this.dragstartModel.pinned&&this.dragstartIndex<this.separatorIndices[this.dragstartKey]},unpinning(){return this.dragging&&this.dragstartModel.pinned&&this.dragstartIndex>this.separatorIndices[this.dragstartKey]}},methods:{copyFilterItems(){this.reorderableItems=[...this.filteredItems]},dragstart(t,e,r,s){this.copyFilterItems(),t.dataTransfer.setData("text/html",t.target.outerHTML),this.dragging=!0,this.dragstartIndex=e,this.dragstartKey=s,this.dragstartModel=r,this.dragTimeout=setTimeout((()=>this.$set(r,"dragging",!0)),100)},dragenter(t,e,r){e!==this.dragstartIndex&&(this.reorderableItems[r].splice(e,0,this.reorderableItems[r].splice(this.dragstartIndex,1)[0]),this.dragstartIndex=e)},drop(t,e){Object.prototype.hasOwnProperty.call(this.collection,"reorder")||console.log('Error: the prop collection does not have the "reorder" method to commit this drop operation.');const r=this.dragstartModel;this.$set(r,"dragging",!1);let s,a,i=!1,n=null;0===t?(s=this.reorderableItems[e][1],i=!0):this.reorderableItems[e][t-1].separator?(s=this.reorderableItems[e][t+1],i=!0):(s=this.reorderableItems[e][t-1],a=this.reorderableItems[e][t+1]),this.separatePinned&&(t<this.separatorIndices[e]&&!r.pinned?n=!0:t>this.separatorIndices[e]&&r.pinned&&(n=!1),null!==n&&this.$set(r,"pinned",n)),this.collection.reorder(this.dragstartModel,s,i,a,n)},dragend(t){clearTimeout(this.dragTimeout),this.$set(t,"dragging",!1),this.dragging=!1,this.dragstartIndex=null,this.dragstartKey=null,this.dragstartModel=null,this.reorderableItems={}}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"box-wrapper",attrs:{slot:"content"},slot:"content"},[e("transition",{attrs:{name:"fade"}},[t.pinning||t.unpinning?e("div",{staticClass:"pin-message"},[t._v(t._s(t.pinning?"Pin":"Unpin"))]):t._e()]),e("div",{staticClass:"items-filter",class:{draggable:t.allowReorder,dragging:t.dragging,pinning:t.pinning,unpinning:t.unpinning}},[t.filteredItems.length?e("ul",{staticClass:"list",attrs:{"data-test":"list"}},t._l(t.dragging?t.reorderableItems[t.key]:t.filteredItems,(function(r,s){return e(t.itemComponent,{key:r.id,tag:"component",attrs:{item:r,"view-manager":t.viewManager},nativeOn:{dragstart:function(e){return t.dragstart(e,s,r,t.key)},dragenter:function(e){return e.preventDefault(),t.dragenter(e,s,t.key)},dragover:function(t){t.preventDefault()},drop:function(e){return t.drop(s,t.key)},dragend:function(e){return t.dragend(r)}}})})),1):e("items-empty",{attrs:{"empty-message":t.filter&&t.filter.emptyMessage||t.collection.emptyMessage,"add-label":t.addLabel,"view-manager":t.viewManager,"data-test":"empty"}})],1)],1)}),[],!1,null,"baf0602c").exports;export{r as default};