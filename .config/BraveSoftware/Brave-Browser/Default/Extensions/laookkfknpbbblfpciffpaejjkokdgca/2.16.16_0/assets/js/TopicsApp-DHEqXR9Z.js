import{V as t,n as s}from"./icon-alert--q0yLTMi.js";import{_ as a}from"./icon-edit-CixeXNYx.js";import{_ as i}from"./icon-close-BUGl_M7j.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";const e=new(t.extend({name:"TopicDataManager",data:()=>({rawData:{},topicData:[],loaded:!1}),localStorageKey:"topic_data",created(){this.rawData=localStorage.getObject("topics"),this.rawData&&(this.$set(this,"topicData",this.buildHierarchy(this.rawData)),this.loaded=!0),this.getData().then((t=>{this.rawData=t,localStorage.setObject("topics",this.rawData),this.$set(this,"topicData",this.buildHierarchy(this.rawData)),this.loaded=!0}))},methods:{getData:()=>new Promise(((t,s)=>{$.ajax({url:m.globals.urlRootApi+"team/topics",success:s=>{t(s)},error:t=>{s(t)}})})),sort:(t,s)=>t.order-s.order,buildHierarchy(t){let s=[];return t&&t.categories&&t.categories.forEach((t=>{t.topics=[],s.push(t)})),t&&t.topics&&t.topics.forEach((t=>{s.filter((s=>s.id===t.categoryId)).forEach((s=>{s.topics.push(t)}))})),s.sort(this.sort).forEach((t=>t.topics.sort(this.sort))),s}}}));const o=s({name:"TopicsApp",computed:{isLoading:()=>!e.loaded,isEmpty(){return!(this.isLoading||this.topicData&&this.topicData.length)},topicData:()=>e.topicData,isAdmin:()=>m.models.teamInfo.get("team").userIsAdmin,categoryCount(){return"category-num-"+this.topicData.length}},mounted(){m.trigger("notification:hide"),this.addListeners(),m.widgetManager.hideApps({exemptionSelectors:".topics, #team-logo"}),m.trigger("topics:open")},destroyed(){m.widgetManager.showApps(),m.trigger("topics:closed"),this.removeListeners()},methods:{editInAccountSite(){m.commandManager.execute("window.account.open.login","/team/topics")},handleGlobalClick(t){this.$parent.$el&&!this.$parent.$el.contains(t.target)&&this.$emit("close")},addListeners(){m.on("globalEvent:esc",this.closeApp),m.on("globalEvent:click",this.handleGlobalClick)},removeListeners(){m.off("globalEvent:esc",this.closeApp),m.off("globalEvent:click",this.handleGlobalClick)},closeApp(){this.$emit("close")},newTabForFileLink(t){m.utils.newTabForFileLink(t)},isUrlLocalFileLink:t=>m.utils.isUrlLocalFileLink(t)}},(function(){var t=this,s=t._self._c;return s("div",{staticClass:"app app-topics",attrs:{id:"topics-app","data-test":"topics-container"}},[s("header",[s("h2",[t._v("Topics")]),t.isAdmin?s("a",{staticClass:"button button-edit",attrs:{target:"_blank"},on:{click:function(s){return t.editInAccountSite()}}},[s("inline-svg",{staticClass:"icon edit-icon",attrs:{src:a}}),s("span",{staticClass:"edit-label"},[t._v("Edit")])],1):t._e(),s("div",{staticClass:"spacer"}),s("div",{staticClass:"icon-wrapper back",attrs:{"data-test":"close"},on:{click:function(s){return s.stopPropagation(),t.$emit("close")}}},[s("inline-svg",{staticClass:"icon icon-hide",attrs:{src:i}})],1)]),s("section",{staticClass:"topics-main"},[s("div",{staticClass:"spacer spacer-top"}),t.isEmpty?t._e():s("ul",{staticClass:"categories",class:t.categoryCount,attrs:{"data-test":"categories"}},t._l(t.topicData,(function(a,i){return s("li",{key:i,staticClass:"category"},[s("div",{staticClass:"category-header"},[a.iconUrl?s("img",{staticClass:"category-icon",attrs:{src:a.iconUrl}}):t._e(),s("div",{staticClass:"category-title"},[t._v(t._s(a.title))])]),s("ul",{staticClass:"topics",attrs:{"data-test":"topics-list"}},t._l(a.topics,(function(a,i){return s("li",{key:i,staticClass:"topic",attrs:{"data-test":"topic"}},[t.isUrlLocalFileLink(a.url)?s("a",{key:"i",staticClass:"u--pointer",attrs:{title:a.url},on:{click:function(s){return t.newTabForFileLink(a.url)}}},[t._v(" "+t._s(a.title)+" ")]):s("a",{key:"i",attrs:{href:a.url}},[t._v(t._s(a.title))])])})),0)])})),0),t.isLoading?s("section",{staticClass:"empty-state"},[s("span",{staticClass:"empty-message"},[t._v("Loading...")])]):t._e(),t.isEmpty?s("section",{staticClass:"empty-state"},[s("span",{staticClass:"empty-message"},[t._v("Your team hasn't added any topics yet.")])]):t._e(),s("div",{staticClass:"spacer spacer-bot"})])])}),[],!1,null,"1a9bd82f").exports;export{o as default};