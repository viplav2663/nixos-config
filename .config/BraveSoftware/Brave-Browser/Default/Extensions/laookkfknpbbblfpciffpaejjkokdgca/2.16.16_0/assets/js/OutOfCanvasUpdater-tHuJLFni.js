import{k as t,K as i,E as o,v as e,V as s,l as n,o as r}from"./FlashMessage-DPJrdJ6u.js";import"./icon-alert--q0yLTMi.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";import"./globalKeyEventManager-Bi-yHy9P.js";import"./icon-close-BUGl_M7j.js";class a{constructor(t){this.container=t,this.modes=["bounce","split"]}update(o,e,s,n){if(!this.modes.includes(n))return;const r=this.container;let a=!1;for(const[,t]of r.plugins)if(void 0!==t.particleBounce&&(a=t.particleBounce(o,s,e)),a)break;if(a)return;const c=o.getPosition(),d=o.offset,p=o.getRadius(),u=i(c,p),l=r.canvas.size;!function(i){if("bounce"!==i.outMode&&"split"!==i.outMode||"left"!==i.direction&&"right"!==i.direction)return;i.bounds.right<0&&"left"===i.direction?i.particle.position.x=i.size+i.offset.x:i.bounds.left>i.canvasSize.width&&"right"===i.direction&&(i.particle.position.x=i.canvasSize.width-i.size-i.offset.x);const o=i.particle.velocity.x;let e=!1;if("right"===i.direction&&i.bounds.right>=i.canvasSize.width&&o>0||"left"===i.direction&&i.bounds.left<=0&&o<0){const o=t(i.particle.options.bounce.horizontal.value);i.particle.velocity.x*=-o,e=!0}if(!e)return;const s=i.offset.x+i.size;i.bounds.right>=i.canvasSize.width&&"right"===i.direction?i.particle.position.x=i.canvasSize.width-s:i.bounds.left<=0&&"left"===i.direction&&(i.particle.position.x=s),"split"===i.outMode&&i.particle.destroy()}({particle:o,outMode:n,direction:e,bounds:u,canvasSize:l,offset:d,size:p}),function(i){if("bounce"!==i.outMode&&"split"!==i.outMode||"bottom"!==i.direction&&"top"!==i.direction)return;i.bounds.bottom<0&&"top"===i.direction?i.particle.position.y=i.size+i.offset.y:i.bounds.top>i.canvasSize.height&&"bottom"===i.direction&&(i.particle.position.y=i.canvasSize.height-i.size-i.offset.y);const o=i.particle.velocity.y;let e=!1;if("bottom"===i.direction&&i.bounds.bottom>=i.canvasSize.height&&o>0||"top"===i.direction&&i.bounds.top<=0&&o<0){const o=t(i.particle.options.bounce.vertical.value);i.particle.velocity.y*=-o,e=!0}if(!e)return;const s=i.offset.y+i.size;i.bounds.bottom>=i.canvasSize.height&&"bottom"===i.direction?i.particle.position.y=i.canvasSize.height-s:i.bounds.top<=0&&"top"===i.direction&&(i.particle.position.y=s),"split"===i.outMode&&i.particle.destroy()}({particle:o,outMode:n,direction:e,bounds:u,canvasSize:l,offset:d,size:p})}}class c{constructor(t){this.container=t,this.modes=["destroy"]}update(t,i,n,r){if(!this.modes.includes(r))return;const a=this.container;switch(t.outType){case"normal":case"outside":if(e(t.position,a.canvas.size,s.origin,t.getRadius(),i))return;break;case"inside":{const{dx:i,dy:e}=o(t.position,t.moveCenter),{x:s,y:n}=t.velocity;if(s<0&&i>t.moveCenter.radius||n<0&&e>t.moveCenter.radius||s>=0&&i<-t.moveCenter.radius||n>=0&&e<-t.moveCenter.radius)return;break}}a.particles.remove(t,void 0,!0)}}class d{constructor(t){this.container=t,this.modes=["none"]}update(t,i,o,n){if(!this.modes.includes(n))return;if((t.options.move.distance.horizontal&&("left"===i||"right"===i))??(t.options.move.distance.vertical&&("top"===i||"bottom"===i)))return;const r=t.options.move.gravity,a=this.container,c=a.canvas.size,d=t.getRadius();if(r.enable){const o=t.position;(!r.inverse&&o.y>c.height+d&&"bottom"===i||r.inverse&&o.y<-d&&"top"===i)&&a.particles.remove(t)}else{if(t.velocity.y>0&&t.position.y<=c.height+d||t.velocity.y<0&&t.position.y>=-d||t.velocity.x>0&&t.position.x<=c.width+d||t.velocity.x<0&&t.position.x>=-d)return;e(t.position,a.canvas.size,s.origin,d,i)||a.particles.remove(t)}}}class p{constructor(t){this.container=t,this.modes=["out"]}update(t,a,c,d){if(!this.modes.includes(d))return;const p=this.container;switch(t.outType){case"inside":{const{x:i,y:e}=t.velocity,n=s.origin;n.length=t.moveCenter.radius,n.angle=t.velocity.angle+Math.PI,n.addTo(s.create(t.moveCenter));const{dx:a,dy:c}=o(t.position,n);if(i<=0&&a>=0||e<=0&&c>=0||i>=0&&a<=0||e>=0&&c<=0)return;t.position.x=Math.floor(r({min:0,max:p.canvas.size.width})),t.position.y=Math.floor(r({min:0,max:p.canvas.size.height}));const{dx:d,dy:u}=o(t.position,t.moveCenter);t.direction=Math.atan2(-u,-d),t.velocity.angle=t.direction;break}default:if(e(t.position,p.canvas.size,s.origin,t.getRadius(),a))return;switch(t.outType){case"outside":{t.position.x=Math.floor(r({min:-t.moveCenter.radius,max:t.moveCenter.radius}))+t.moveCenter.x,t.position.y=Math.floor(r({min:-t.moveCenter.radius,max:t.moveCenter.radius}))+t.moveCenter.y;const{dx:i,dy:e}=o(t.position,t.moveCenter);t.moveCenter.radius&&(t.direction=Math.atan2(e,i),t.velocity.angle=t.direction);break}case"normal":{const o=t.options.move.warp,e=p.canvas.size,s={bottom:e.height+t.getRadius()+t.offset.y,left:-t.getRadius()-t.offset.x,right:e.width+t.getRadius()+t.offset.x,top:-t.getRadius()-t.offset.y},r=t.getRadius(),c=i(t.position,r);"right"===a&&c.left>e.width+t.offset.x?(t.position.x=s.left,t.initialPosition.x=t.position.x,o||(t.position.y=n()*e.height,t.initialPosition.y=t.position.y)):"left"===a&&c.right<-t.offset.x&&(t.position.x=s.right,t.initialPosition.x=t.position.x,o||(t.position.y=n()*e.height,t.initialPosition.y=t.position.y)),"bottom"===a&&c.top>e.height+t.offset.y?(o||(t.position.x=n()*e.width,t.initialPosition.x=t.position.x),t.position.y=s.top,t.initialPosition.y=t.position.y):"top"===a&&c.bottom<-t.offset.y&&(o||(t.position.x=n()*e.width,t.initialPosition.x=t.position.x),t.position.y=s.bottom,t.initialPosition.y=t.position.y);break}}}}}const u=(t,i)=>t.default===i||t.bottom===i||t.left===i||t.right===i||t.top===i;class l{constructor(t){this._updateOutMode=(t,i,o,e)=>{for(const s of this.updaters)s.update(t,e,i,o)},this.container=t,this.updaters=[]}init(t){this.updaters=[];const i=t.options.move.outModes;u(i,"bounce")?this.updaters.push(new a(this.container)):u(i,"out")?this.updaters.push(new p(this.container)):u(i,"destroy")?this.updaters.push(new c(this.container)):u(i,"none")&&this.updaters.push(new d(this.container))}isEnabled(t){return!t.destroyed&&!t.spawning}update(t,i){const o=t.options.move.outModes;this._updateOutMode(t,i,o.bottom??o.default,"bottom"),this._updateOutMode(t,i,o.left??o.default,"left"),this._updateOutMode(t,i,o.right??o.default,"right"),this._updateOutMode(t,i,o.top??o.default,"top")}}export{l as OutOfCanvasUpdater};