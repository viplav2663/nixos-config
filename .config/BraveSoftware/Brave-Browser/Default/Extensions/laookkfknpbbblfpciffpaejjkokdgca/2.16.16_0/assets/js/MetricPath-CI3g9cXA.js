import{S as t}from"./SmoothReflow-Du5fECCq.js";import{m as e}from"./metricCollection-JKwIPpBA.js";import{n as s}from"./icon-alert--q0yLTMi.js";import"./allComponentsMounted-C3UsG_cA.js";import"./preload-helper-DmNsytk6.js";import"./VueBase-W7f1OYgs.js";import"./index-DQvfDEB6.js";import"./localStorage-4iHdj-SC.js";import"./migrateLegacyUserMessageHandler-DMvEmYM4.js";import"./main-FH8FpKq2.js";import"./index-CJJH83pl.js";import"./portal-vue.esm-SV1wohGy.js";import"./itemDataServiceMixins-DPsPiv13.js";import"./itemModelMixin-B7XBtNZL.js";import"./reactiveCustomization-DqGARD3C.js";import"./namesMixin-DfNb5KMg.js";import"./metricMetadata-D4pZaGht.js";import"./clocks-DjzskNOU.js";import"./captureMixin-D0enqjOF.js";import"./string-GDe0WbEj.js";const o=s({name:"MetricPath",components:{SmoothReflow:t},timeout:null,props:{value:{type:String,default:""},componentFieldWarnings:{type:Array,default:()=>[]},viewManager:{type:Object,required:!0}},data:()=>({pathOptions:[],loading:!1,noResults:!1}),computed:{activeItem(){return this.viewManager.activeItem},editProps(){return this.viewManager.editProps},collection(){return this.viewManager.collection},showPathSelect(){var t,e;return(null==(t=this.urlWithProtocol)?void 0:t.includes("."))||location.href.includes("localhost")&&(null==(e=this.urlWithProtocol)?void 0:e.includes("localhost"))},highlightError(){return-1!==this.componentFieldWarnings.indexOf("path")},urlWithProtocol(){return m.utils.ensureUrlScheme(this.editProps.url)}},watch:{urlWithProtocol(t){this.debouncedGetUrlPaths(t)}},mounted(){this.editProps.url&&this.debouncedGetUrlPaths(this.urlWithProtocol,!0)},methods:{debouncedGetUrlPaths(t,s){this.loading=!0,this.noResults=!1;const o=()=>{e.getPathOptions(t).then((t=>{const e=t.data&&t.data.values;e.length?this.$set(this,"pathOptions",e.map((t=>({label:`${t.path}: ${t.value}`,path:t.path,value:t.value})))):this.noResults=!0})).catch((()=>{this.noResults=!0})).finally((()=>this.loading=!1))};s?o():this.showPathSelect&&(clearTimeout(this.$options.timeout),this.$options.timeout=setTimeout(o,1e3))},onInput(t){const e=t.target,s=e.options[e.selectedIndex].attributes["data-value"].value;this.$set(this.editProps,"value",s),this.$emit("input",e.value)}}},(function(){var t=this,e=t._self._c;return e("smooth-reflow",{attrs:{nested:!0,"hide-overflow":!0}},[e("transition",{attrs:{name:"fade"}},[t.showPathSelect?e("div",[e("label",[t._v("Value")]),e("div",{staticClass:"path-select-wrapper",class:{"select-wrapper":!(t.loading||t.noResults)}},[e("select",{staticClass:"path-select",class:{error:t.highlightError},attrs:{disabled:t.loading||t.noResults,"data-test":"path-select"},domProps:{value:t.value},on:{input:t.onInput}},[t.noResults?t._e():e("option",{attrs:{disabled:"",value:""}},[t._v("Select an option")]),t._l(t.pathOptions,(function(s,o){return e("option",{key:o,attrs:{"data-value":s.value},domProps:{value:s.path}},[t._v(" "+t._s(s.label))])}))],2),t.loading||t.noResults?e("div",{staticClass:"select-overlay-wrapper"},[t.loading?e("div",{staticClass:"select-overlay"},[t._v("Loading...")]):t.noResults?e("div",{staticClass:"select-overlay"},[t._v("No Results")]):t._e()]):t._e()])]):t._e()])],1)}),[],!1,null,"f1b83016").exports;export{o as default};