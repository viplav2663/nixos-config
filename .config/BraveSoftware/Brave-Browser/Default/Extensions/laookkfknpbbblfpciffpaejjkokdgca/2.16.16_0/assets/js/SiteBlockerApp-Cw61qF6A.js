import{o as e,z as t,ar as s,a8 as i,n as o,K as r,e as n}from"./icon-alert--q0yLTMi.js";import{A as a}from"./AppPopup-CAECMUMV.js";import{A as l}from"./AppViewSwitchDynamic-CG-8EiMD.js";import{u as p,S as c}from"./main-C0pp867X.js";import{A as u}from"./AppView-DvfYjlXn.js";import{a as m,A as d,b}from"./AppHeader-DgK-F-wR.js";import{B as h}from"./BaseIcon-B5UifJH3.js";import{B as f}from"./BaseItemList-C404Gcql.js";import{u as w,a as g,S as v}from"./siteBlockerGroups-E8GFJ9Dm.js";import{T as S}from"./ToggleSwitch-DUGISQcW.js";import{g as y}from"./globalKeyEventManager-Bi-yHy9P.js";import{B as k}from"./BaseForm-DZdqvzm3.js";import{A as j}from"./AppLoading-DC9RO0Iq.js";import I from"./siteBlockerSession-DPf8kIYl.js";import{F as A}from"./FavIcon-Ba-H42pn.js";import{a as C}from"./string-GDe0WbEj.js";import{A as _}from"./AppEmpty-vIXfvRp8.js";import{e as B}from"./index-DQvfDEB6.js";import{A as x,a as G}from"./AppActionBanner-BfW8Mjx3.js";import{A as R}from"./AppHeaderControl-FZTURLhY.js";import{B as D}from"./BaseDropdown-DBvV1Fy2.js";import{B as W}from"./BaseDropdownOption-umPWLVqy.js";import{c as N}from"./preload-helper-DmNsytk6.js";import{A as P,a as V}from"./AppConfirmCancel-BJUvVb0h.js";import"./localStorage-4iHdj-SC.js";import"./SmoothReflow-Du5fECCq.js";import"./allComponentsMounted-C3UsG_cA.js";import"./VueBase-W7f1OYgs.js";import"./index-CJJH83pl.js";import"./portal-vue.esm-SV1wohGy.js";import"./AppContainer-DnRychOY.js";import"./showAnyway-d_ZUKj8O.js";import"./reactiveCustomization-DqGARD3C.js";import"./migrateLegacyUserMessageHandler-DMvEmYM4.js";import"./main-FH8FpKq2.js";import"./appToggleMixin-IV4cErk-.js";import"./ViewState-_YxhE_TX.js";import"./AppDash-CAm0VyUo.js";import"./icon-hide-NFfBhfBx.js";import"./arrow-Be8MuPJi.js";import"./icon-weather-reset-C06kxk3l.js";import"./icon-settings-Bycjf8-G.js";import"./icon-back-arrow-CiRQJ6G-.js";import"./icon-back-D_TFrgyJ.js";import"./icon-trash-BQ1O-AfY.js";import"./icon-close-BUGl_M7j.js";import"./icon-cog-BFr_Pva7.js";import"./icon-skip-BOkC5L0N.js";import"./icon-down-BiHbKN-t.js";import"./icon-edit-CixeXNYx.js";import"./icon-ellipsis-D3jS4u3x.js";import"./icon-error-state-BKQhfBCj.js";import"./icon-heart-v5O7C6eS.js";import"./icon-key-BPNRipb3.js";import"./icon-next-B4hjdiAA.js";import"./icon-photo-BrwqV1T0.js";import"./icon-pin-BHeOuzvO.js";import"./icon-plus-D4YOesIc.js";import"./icon-profile-B_XWyuTb.js";import"./icon-x-qUCmf2CW.js";import"./icon-skip-intro-BUi8b3Ak.js";import"./icon-tooltip-CN09iXOB.js";import"./icon-visible-on-CM3kpcFN.js";import"./icon-x-caret-half-CZtcH_PM.js";import"./tasks-completed-Dg2z75km.js";import"./add-COIuonao.js";import"./google-DKPAcOmk.js";import"./arrow-up-1QPpu78M.js";import"./square-check-DwLT60gj.js";import"./clocks-DjzskNOU.js";import"./close-Bj_A2br_.js";import"./search-DCqlmJx6.js";import"./folder-CwWTWsnJ.js";import"./switch-EuBTQVVE.js";import"./focus-mode-09pIyYAW.js";import"./storage-YYEO5TB5.js";import"./icon-confetti-Dz2LojDe.js";import"./ocean-bubbles-GcKjBI5B.js";import"./sparks-CAw9b6ob.js";import"./secure-B8YP-AML.js";import"./icon-asana-Csd73e1k.js";import"./icon-percent-schedule-CA5EI9b7.js";import"./icon-trello-DhCq-Fsi.js";import"./icon-clean-rFsPxTtp.js";import"./icon-more-lists-Cl9oRGK2.js";import"./icon-more-fonts-CcfOY0t4.js";import"./icon-focus-stats-keERwXFt.js";import"./icon-top-of-mind-B6EhbCcK.js";import"./icon-flow-5QqmGIWX.js";import"./icon-integrations-D9o58ob4.js";import"./icon-weather-extra-ufLpT_SX.js";import"./icon-spiral-gh4hwZDD.js";import"./icon-happy-place-D1z6CJgM.js";import"./icon-time-sensitive-CP2L3maw.js";import"./icon-hourly-CdMmiQZT.js";import"./icon-infinity-D4yMRoAd.js";import"./icon-personalize-photos-D2M4lLlt.js";import"./icon-skip-2bGCAGKt.js";import"./icon-photo-match-C2EChNEK.js";import"./icon-random-375DbcwF.js";import"./icon-timezones-DGZoTtaT.js";import"./icon-simplify-BRUtLJYp.js";import"./icon-sync-DIH26Y9h.js";import"./constants-BpVlFj04.js";import"./constants-BT5o8PmI.js";import"./compareObjects-BF7sSNEf.js";import"./FormMessage-D_iGngUy.js";import"./focusModeViewState-BpbRF0A0.js";import"./focusModeHelpers-CiIJnkuY.js";import"./scenes-D8jpYIdj.js";import"./PomodoroTimers-BWkB-14p.js";import"./pomodoroCompleted-DWEcdQPX.js";import"./loginHelpers-BZASe8UD.js";import"./authService-CGVTYYkM.js";import"./customization-fX3KDebH.js";import"./BaseDropdownContent-BSCj37As.js";import"./constants-CALDQiUE.js";import"./index-D7SyL4qE.js";const E=o(e({name:"FormEditableSpan",props:{value:{type:String,required:!0},placeholder:{type:String,default:""},editing:{type:Boolean,default:!1},name:{type:String,default:"inline-input"}},emits:["input"],setup:()=>({inputRef:t(),formFields:s("formFields")}),data:()=>({pulse:!1,focused:!1}),watch:{focused(){this.focused?y.registerEventListener("blurInlineInput","keyup",27,this.blur):this.clearEscapeEventIfListening()}},created(){var e;null==(e=this.formFields)||e.addField(this.name,this.focus,this.pulseAndFocus)},destroyed(){var e;null==(e=this.formFields)||e.removeField(this.name),this.clearEscapeEventIfListening()},methods:{emitInputValue(e){const t=e.target.value;this.$emit("input",t)},async focus(){var e;await this.$nextTick(),null==(e=this.inputRef)||e.focus()},blur(){var e;null==(e=this.inputRef)||e.blur()},async pulseAndFocus(){await this.focus(),this.pulse=!0,await i(1e3),this.pulse=!1},submitAndSetBlurred(){var e;null==(e=this.formFields)||e.submitOnBlurAndNoneFocused(),this.focused=!1},setFocused(){this.focused=!0},clearEscapeEventIfListening(){y.hasEventListener("blurInlineInput","keyup",27)&&y.removeEventListener("blurInlineInput","keyup",27)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("span",{staticClass:"inline-input",class:{editing:e.editing},attrs:{name:e.name,"data-test-value":e.value}},[t("input",{ref:"inputRef",class:{pulse:e.pulse},attrs:{type:"text",placeholder:e.placeholder,readonly:!e.editing},domProps:{value:e.value},on:{click:function(e){e.stopPropagation()},input:e.emitInputValue,keydown:function(t){var s;if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;null==(s=e.formFields)||s.focusNextInputOrSubmitIfLast(e.name)},blur:e.submitAndSetBlurred,focus:e.setFocused}}),t("span",{staticClass:"reference-text"},[e._v(e._s(e.value||e.placeholder))])])}),[],!1,null,"f42c6933").exports,M=e({name:"SiteBlockerGroupsListItem",components:{BaseForm:k,FormEditableSpan:E,BaseIcon:h,ToggleSwitch:S},props:{group:{type:Object,required:!0},newGroup:{type:Boolean,default:!1}},setup:()=>({groupsStore:w(),viewStateStore:p(),inlineInputRef:t(),formRef:t(),capture:s("capture")}),mounted(){var e;this.newGroup&&(null==(e=this.inlineInputRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.group.enabled=!this.group.enabled,!this.newGroup)return null==(e=this.capture)||e.call(this,"site blocker toggle group",{defaultKey:this.group.defaultKey}),this.groupsStore.update(this.group.id,{enabled:this.group.enabled})},createNewGroup(){var e;if(this.newGroup)return this.group.validate(),this.groupsStore.clearActiveItem(),null==(e=this.capture)||e.call(this,"site blocker create new group",{defaultKey:this.group.defaultKey}),this.groupsStore.create(this.group)},async goToGroupWebsitesIfNotNewGroup(){var e;this.newGroup||(this.groupsStore.editItem(this.group.id),await(null==(e=this.viewStateStore)?void 0:e.setActiveView(c.Websites)))}}});const F=o(e({name:"SiteBlockerGroupsList",components:{BaseIcon:h,SiteBlockerGroupsListItem:o(M,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("li",{staticClass:"site-blocker-groups-list-item app-list-item-lines-between",attrs:{"data-test":"groups-list-item"},on:{click:e.goToGroupWebsitesIfNotNewGroup}},[t("base-form",{ref:"formRef",staticClass:"list-item-form",attrs:{submit:e.createNewGroup,"submit-button":!1,"submit-on-blur":!0}},[t("div",{staticClass:"list-item-content",class:{editing:e.newGroup}},[t("form-editable-span",{ref:"inlineInputRef",staticClass:"group-websites-input",attrs:{name:"name-input",editing:e.newGroup,placeholder:"New group","data-test":"groups-list-item-input"},model:{value:e.group.name,callback:function(t){e.$set(e.group,"name",t)},expression:"group.name"}}),e.newGroup?e._e():t("span",{staticClass:"group-websites-count"},[e._v(e._s(e.group.totalWebsites))]),t("toggle-switch",{attrs:{value:e.group.enabled,"data-test":"groups-list-item-toggle"},on:{click:function(t){return t.stopPropagation(),e.toggleEnabled.apply(null,arguments)}}}),t("div",{staticClass:"icon-wrapper group-websites-view u--mobile-show-bg",class:{disabled:e.newGroup},attrs:{"data-test":"groups-list-item-websites"}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-next",size:"10px"}})],1)],1)])],1)}),[],!1,null,"7bfe9cca").exports,BaseItemList:f},setup:()=>({groupsStore:w()}),computed:{editingExistingGroup(){return!!this.groupsStore.activeItem&&!!this.groupsStore.getGroupOrDefaultFromId(this.groupsStore.activeItem.id)}},methods:{createNewGroup(){this.groupsStore.newItem()}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-list"},[t("div",{staticClass:"groups-header"},[t("span",{staticClass:"groups-header-title"},[e._v("Blocked groups")]),t("div",{staticClass:"icon-wrapper",attrs:{"data-test":"new-group"},on:{click:e.createNewGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus",size:"12px"}})],1)]),t("base-item-list",[e.groupsStore.activeItem&&!e.editingExistingGroup?t("site-blocker-groups-list-item",{key:e.groupsStore.activeItem.id,attrs:{group:e.groupsStore.activeItem,"new-group":!0}}):e._e(),e._l(e.groupsStore.items,(function(e){return t("site-blocker-groups-list-item",{key:e.id,attrs:{group:e}})}))],2)],1)}),[],!1,null,"c9a82ea7").exports,O=e({name:"SiteBlockerGroupsBlockingBannerIcon",components:{FavIcon:A},props:{url:{type:String,required:!0}},setup:()=>({yDisplacement:"0rem",xDisplacement:"0rem",animationStart:"0s",animationSpeed:"10s"}),created(){this.yDisplacement=4*Math.random()-2+"rem",this.xDisplacement=2.25*Math.random()+1.5+"rem";const e=5*Math.random()+35;this.animationSpeed=e+"s",this.animationStart=-1*Math.random()*e+"s"}}),L=()=>{r(((e,t)=>({"99fb043a":e.xDisplacement,"201f1e6f":e.animationSpeed,"2020e28a":e.animationStart,bcf4f738:e.yDisplacement})))},T=O.setup;O.setup=T?(e,t)=>(L(),T(e,t)):L;const K=e({name:"SiteBlockerGroupsBlockingBanner",components:{SiteBlockerGroupsBlockingBannerIcon:o(O,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-blocking-banner-icon"},[t("fav-icon",{staticClass:"favicon",attrs:{url:e.url}})],1)}),[],!1,null,"b6e1f749").exports,BaseIcon:h},setup:()=>({sessionStore:I(),iconRangeInterval:void 0}),data:()=>({visibleIconRangeMin:0,visibleIconRangeMax:0,iconsVisible:!1}),computed:{urls(){return""===this.sessionStore.urls?[]:this.sessionStore.urls.replaceAll("*","com").split(" ")}},watch:{urls(){this.setRandomIconRange()}},created(){this.setRandomIconRange(),this.iconRangeInterval=setInterval((()=>{this.visibleIconRangeMin=C(this.urls,this.visibleIconRangeMin,1),this.visibleIconRangeMax=C(this.urls,this.visibleIconRangeMax,1)}),5e3),setTimeout((()=>{this.iconsVisible=!0}),200)},destroyed(){clearInterval(this.iconRangeInterval)},methods:{setRandomIconRange(){const e=Math.floor(Math.random()*this.urls.length);this.visibleIconRangeMin=e,this.visibleIconRangeMax=C(this.urls,e,Math.min(this.urls.length-1,10))},isIconInRange(e){return this.visibleIconRangeMax<this.visibleIconRangeMin?e>=0&&e<=this.visibleIconRangeMax||e>=this.visibleIconRangeMin&&e<=this.urls.length-1:(e-this.visibleIconRangeMin)*(e-this.visibleIconRangeMax)<=0}}});const U=o(e({name:"SiteBlockerGroups",components:{AppActionBanner:x,AppButtonRow:G,AppEmpty:_,AppLoading:j,SiteBlockerGroupsBlockingBanner:o(K,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("transition-group",{staticClass:"site-blocker-groups-blocking-banner",attrs:{tag:"div",name:"slow-fade-icon"}},[t("div",{key:"blocking-browser",staticClass:"blocking-browser",attrs:{"data-test":"blocking-browser"}},[t("div",{staticClass:"blocking-nav"},[t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item nav-bar"})]),t("base-icon",{attrs:{src:"icon/denied",size:"2rem"}}),t("span",{staticClass:"blocking-message"},[e._v("Blocking distractions")])],1),e._l(e.urls,(function(s,i){return e.iconsVisible&&e.isIconInRange(i)?t("site-blocker-groups-blocking-banner-icon",{key:`${s}`,attrs:{url:s}}):e._e()}))],2)}),[],!1,null,"7ae7d69e").exports,SiteBlockerGroupsList:F,BaseIcon:h,AppHeader:m,AppView:u},setup:()=>({groupsStore:w(),websitesStore:g(),sessionStore:I(),capture:s("capture")}),computed:{loaded(){return this.groupsStore.loaded&&this.websitesStore.loaded},hasActiveItem(){return!!this.groupsStore.activeItem},empty(){return 0===this.groupsStore.items.length},focusModeActive:()=>B.currentValue,manualToggleControlsVisible(){return!this.focusModeActive&&!this.empty&&this.loaded}},created(){this.groupsStore.refresh(),this.websitesStore.refresh()},methods:{createNewGroup(){this.groupsStore.newItem()},async toggleBlockingActive(){var e;this.sessionStore.active||this.sessionStore.hasPermissions||await this.sessionStore.ensurePermissions(),this.sessionStore.toggleActive(),null==(e=this.capture)||e.call(this,"site blocker manual toggle active",{active:this.sessionStore.active})}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-groups",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{src:"icon/apps/site-blocker",size:"16px"}}),t("span",{staticClass:"app-header-name"},[e._v("Site Blocker")])]},proxy:!0}])}),e.sessionStore.featureEnabled&&!e.sessionStore.hasPermissions?t("app-action-banner",{attrs:{"action-text":"Grant permissions",text:"We need new permissions to handle blocking sites","data-test":"grant-permissions"},on:{action:function(t){return e.sessionStore.ensurePermissions(!0)}}}):e._e(),e.sessionStore.featureEnabled||e.focusModeActive?e._e():t("app-action-banner",{attrs:{"action-text":"Renew",text:"Plus subscription expired."},on:{action:e.sessionStore.checkSiteBlockerFeatureDisabledAndOpenUpsell}}),e.manualToggleControlsVisible?t("app-button-row",[t("button",{staticClass:"button",attrs:{"data-test":"toggle-blocking"},on:{click:e.toggleBlockingActive}},[e._v(" "+e._s(e.sessionStore.active?"Stop":"Start")+" blocking websites ")])]):e._e()]},proxy:!0},{key:"body",fn:function(){return[t("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[e.loaded?t("div",[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a group to get started","button-text":"Add Group","button-data-test":"new-group-empty"},on:{buttonClick:e.createNewGroup}}):[t("transition",{attrs:{name:"blocking-fade"}},[e.sessionStore.activeAndBlockingUrls?t("site-blocker-groups-blocking-banner",{class:{"toggle-visible":e.manualToggleControlsVisible}}):e._e()],1),t("site-blocker-groups-list")]],2):t("app-loading",{attrs:{"data-test":"groups-loading"}})],1)]},proxy:!0}])})}),[],!1,null,"85585224").exports;const $=o(e({name:"BaseDropdownConfirmation",components:{AppConfirmCancel:P},props:V,emits:["cancel","delete"],setup:()=>({AppConfirmCancelType:d})}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("app-confirm-cancel",e._g(e._b({attrs:{"data-test":"dropdown-confirm-delete"}},"app-confirm-cancel",e.$props,!1),e.$listeners))],1)}),[],!1,null,"7f4cb52f").exports,H=e({name:"SiteBlockerWebsitesListItem",components:{BaseDropdownConfirmation:$,FormEditableSpan:E,BaseForm:k,FavIcon:A,BaseIcon:h,BaseDropdownOption:W,BaseDropdown:D,ToggleSwitch:S},props:{website:{type:Object,required:!0},editing:{type:Boolean,default:!1},newWebsite:{type:Boolean,default:!1}},setup:()=>({viewStateStore:p(),websitesStore:g(),websitesDropdownRef:t(),inputNameRef:t(),inputUrlRef:t(),capture:s("capture")}),computed:{urlNameIfEmpty(){var e,t;if(this.website.name)return this.website.name;const s=null==(t=null==(e=this.website.url)?void 0:e.split("."))?void 0:t.at(-2);return s&&s.length>4&&N(s)||""},namePlaceholder(){return""===this.website.url||""===this.urlNameIfEmpty?"Website Name":this.urlNameIfEmpty},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===d.Dropdown}},mounted(){var e;this.newWebsite&&(null==(e=this.inputUrlRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.website.enabled=!this.website.enabled,!this.newWebsite)return null==(e=this.capture)||e.call(this,"site blocker toggle website"),this.websitesStore.update(this.website.id,{enabled:this.website.enabled})},async editWebsite(e){var t,s,i,o,r;(!this.websitesStore.activeItem||!this.editing&&await(null==(t=this.viewStateStore)?void 0:t.setConfirmation({title:"Are you sure you want to edit?",description:"All unsaved changes will be lost!",type:d.Dropdown})))&&(null==(s=this.capture)||s.call(this,"site blocker edit website",{defaultKey:this.website.defaultKey}),this.websitesStore.editItem(this.website.id)),null==(i=this.websitesDropdownRef)||i.closeDropdown(),await this.$nextTick(),e?null==(o=this.inputNameRef)||o.focus():null==(r=this.inputUrlRef)||r.focus()},async deleteWebsite(){var e,t,s,i;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete?",type:d.Dropdown}))&&(null==(t=this.websitesDropdownRef)||t.closeDropdown(),await this.websitesStore.delete(this.website.id),null==(s=this.capture)||s.call(this,"site blocker delete website",{defaultKey:this.website.defaultKey}),(null==(i=this.websitesStore.activeItem)?void 0:i.id)===this.website.id&&this.websitesStore.clearActiveItem())},validateWebsite(){this.website.name=this.urlNameIfEmpty,this.website.validate()},async createNewWebsiteOrUpdateIfNameUrl(){var e,t;if(this.editing)return this.websitesStore.clearActiveItem(),this.newWebsite?(null==(e=this.capture)||e.call(this,"site blocker create website",{defaultKey:this.website.defaultKey}),this.websitesStore.create(this.website)):(null==(t=this.capture)||t.call(this,"site blocker update website",{defaultKey:this.website.defaultKey}),this.websitesStore.update(this.website.id,{name:this.website.name,url:this.website.url}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const z=e({name:"SiteBlockerWebsitesList",components:{SiteBlockerWebsitesListItem:o(H,(function(){var e,t,s=this,i=s._self._c;return s._self._setupProxy,i("li",{staticClass:"site-blocker-websites-list-item app-list-item-lines-between",attrs:{"data-test":"websites-list-item"}},[i("base-form",{staticClass:"list-item-form",class:{editing:s.editing},attrs:{submit:s.createNewWebsiteOrUpdateIfNameUrl,validate:s.validateWebsite,"submit-button":!1,"submit-on-blur":!0}},[i("div",{staticClass:"list-item-top-row"},[s.editing?s._e():i("fav-icon",{staticClass:"url-favicon",attrs:{url:s.website.urlWithReplacedWildcard}}),i("form-editable-span",{ref:"inputNameRef",staticClass:"name-input",attrs:{editing:s.editing,name:"name-input",placeholder:s.namePlaceholder,"data-test":"websites-list-item-name-input"},nativeOn:{dblclick:function(e){return s.editWebsite(!0)}},model:{value:s.website.name,callback:function(e){s.$set(s.website,"name",e)},expression:"website.name"}}),i("toggle-switch",{attrs:{value:s.website.enabled,"data-test":"websites-list-item-toggle"},on:{click:s.toggleEnabled}}),i("base-dropdown",{ref:"websitesDropdownRef",attrs:{"data-test":"website-options-dropdown"},on:{toggle:s.clearConfirmationIfOpen}},[s.dropdownConfirmationVisible&&(null==(e=s.viewStateStore)?void 0:e.confirmationProps)?i("base-dropdown-confirmation",s._b({},"base-dropdown-confirmation",null==(t=s.viewStateStore)?void 0:t.confirmationProps,!1)):[i("base-dropdown-option",{attrs:{"data-test":"edit-website"},on:{click:function(e){return s.editWebsite(!1)}}},[i("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),s._v(" Edit ")],1),i("base-dropdown-option",{attrs:{"data-test":"delete-website"},on:{click:s.deleteWebsite}},[i("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),s._v(" Delete ")],1)]],2)],1),i("div",{staticClass:"list-item-bottom-row"},[i("form-editable-span",{ref:"inputUrlRef",staticClass:"url-input",attrs:{editing:s.editing,name:"url-input",placeholder:"URL","data-test":"websites-list-item-url-input"},nativeOn:{dblclick:function(e){return s.editWebsite(!1)}},model:{value:s.website.url,callback:function(e){s.$set(s.website,"url",e)},expression:"website.url"}})],1)])],1)}),[],!1,null,"98e8b575").exports,BaseItemList:f},setup:()=>({websitesStore:g(),groupsStore:w()}),computed:{activeGroup(){return this.groupsStore.activeItem??new v({order:this.groupsStore.items.length})},websites(){return this.websitesStore.getWebsitesByGroup(this.activeGroup)},editingExistingWebsite(){return!!this.websitesStore.activeItem&&!!this.websitesStore.getWebsiteOrDefaultFromId(this.websitesStore.activeItem.id)}},methods:{createNewWebsite(){this.websitesStore.newItem(this.activeGroup)}}});const q=e({name:"SiteBlockerWebsites",components:{AppActionBanner:x,BaseDropdownConfirmation:$,BaseForm:k,AppEmpty:_,AppConfirmCancel:P,SiteBlockerWebsitesList:o(z,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("base-item-list",[e.websitesStore.activeItem&&!e.editingExistingWebsite?t("site-blocker-websites-list-item",{key:e.websitesStore.activeItem.id,attrs:{website:e.websitesStore.activeItem,editing:!0,"new-website":!0}}):e._e(),e._l(e.websites,(function(s){var i,o;return t("site-blocker-websites-list-item",{key:s.id,attrs:{website:(null==(i=e.websitesStore.activeItem)?void 0:i.id)===s.id?e.websitesStore.activeItem:s,editing:(null==(o=e.websitesStore.activeItem)?void 0:o.id)===s.id}})}))],2)}),[],!1,null,null).exports,BaseDropdownOption:W,BaseDropdown:D,FormEditableSpan:E,AppHeaderControl:R,AppView:u,AppHeader:m,BaseIcon:h},setup:()=>({viewStateStore:p(),groupsStore:w(),websitesStore:g(),sessionStore:I(),nameInputRef:t(),groupDropdownRef:t(),capture:s("capture"),AppHeaderCenterAlignment:b}),data:()=>({editingGroupName:!1}),computed:{activeGroup(){return this.groupsStore.activeItem??new v({order:this.groupsStore.items.length})},hasActiveItem(){return!!this.websitesStore.activeItem},empty(){return 0===this.websitesStore.getWebsitesByGroup(this.activeGroup).length},overlayConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===d.Overlay},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===d.Dropdown}},mounted(){this.viewStateStore&&(this.viewStateStore.beforeViewChange=()=>(this.editingGroupName||this.websitesStore.activeItemHasChanges)&&this.viewStateStore?this.viewStateStore.setConfirmation({title:"Are you sure you want to cancel?",description:"All unsaved changes will be lost!",type:d.Overlay,dashboardOverlay:!0}):Promise.resolve(!0))},destroyed(){var e;null==(e=this.viewStateStore)||e.resetBeforeViewChange(),this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{async goToGroups(){var e;await(null==(e=this.viewStateStore)?void 0:e.setActiveView(c.Groups))},createNewWebsite(){this.websitesStore.newItem(this.activeGroup)},async renameGroup(){var e,t;null==(e=this.groupDropdownRef)||e.closeDropdown(),this.editingGroupName=!0,await this.$nextTick(),null==(t=this.nameInputRef)||t.focus()},async deleteGroup(){var e,t,s;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete this group?",type:d.Dropdown}))&&(null==(t=this.groupDropdownRef)||t.closeDropdown(),this.websitesStore.clearActiveItem(),null==(s=this.capture)||s.call(this,"site blocker delete group",{defaultKey:this.activeGroup.defaultKey}),await this.groupsStore.delete(this.activeGroup.id),await this.goToGroups())},updateGroupNameIfName(){var e;""!==this.activeGroup.name&&(this.editingGroupName=!1,null==(e=this.capture)||e.call(this,"site blocker update group",{defaultKey:this.activeGroup.defaultKey}),this.groupsStore.update(this.activeGroup.id,{name:this.activeGroup.name}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const J=o(e({name:"SiteBlockerApp",components:{SiteBlockerWebsites:o(q,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-websites",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{on:{click:e.goToGroups}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/arrow-left"}})],1),t("base-form",{staticClass:"group-name-form",attrs:{submit:e.updateGroupNameIfName,"submit-button":!1,"submit-on-blur":!0}},[t("form-editable-span",{ref:"nameInputRef",staticClass:"name-input app-header-name",attrs:{placeholder:"Edit group",editing:e.editingGroupName,"data-test":"websites-group-name-input"},nativeOn:{dblclick:function(t){return e.renameGroup.apply(null,arguments)}},model:{value:e.activeGroup.name,callback:function(t){e.$set(e.activeGroup,"name",t)},expression:"activeGroup.name"}})],1)]},proxy:!0},{key:"right",fn:function(){var s,i;return[t("app-header-control",{attrs:{"data-test":"new-website"},on:{click:e.createNewWebsite}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus"}})],1),t("base-dropdown",{ref:"groupDropdownRef",attrs:{"data-test":"group-options-dropdown"},on:{toggle:e.clearConfirmationIfOpen}},[e.dropdownConfirmationVisible&&(null==(s=e.viewStateStore)?void 0:s.confirmationProps)?t("base-dropdown-confirmation",e._b({},"base-dropdown-confirmation",null==(i=e.viewStateStore)?void 0:i.confirmationProps,!1)):[t("base-dropdown-option",{attrs:{"data-test":"edit-group"},on:{click:e.renameGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),e._v(" Rename ")],1),t("base-dropdown-option",{attrs:{"data-test":"delete-group"},on:{click:e.deleteGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),e._v(" Delete ")],1)]],2)]},proxy:!0}])}),e.sessionStore.hasPermissions?e._e():t("app-action-banner",{attrs:{"action-text":"Grant permissions",text:"We need new permissions to handle blocking sites","data-test":"grant-permissions"},on:{action:function(t){return e.sessionStore.ensurePermissions(!0)}}})]},proxy:!0},{key:"body",fn:function(){return[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a website to get started","button-text":"Add Website","button-data-test":"new-website-empty"},on:{buttonClick:e.createNewWebsite}}):t("site-blocker-websites-list")]},proxy:!0},{key:"confirm",fn:function(){var s;return[e.overlayConfirmationVisible&&(null==(s=e.viewStateStore)?void 0:s.confirmationProps)?t("app-confirm-cancel",e._b({},"app-confirm-cancel",e.viewStateStore.confirmationProps,!1)):e._e()]},proxy:!0}])})}),[],!1,null,"0366f405").exports,SiteBlockerGroups:U,AppPopup:a,AppViewSwitchDynamic:l},setup:()=>({groupsStore:w(),websitesStore:g(),viewStateStore:p()}),computed:{groupsViewActive(){return this.viewStateStore.activeViewId===c.Groups},websitesViewActive(){return this.viewStateStore.activeViewId===c.Websites}},destroyed(){this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{checkSiteBlockerGroupViewOpen(){this.groupsViewActive?n.$emit("siteBlockerGroups:opened"):n.$emit("siteBlockerGroups:closed")}}}),(function(){var e,t,s=this,i=s._self._c;return s._self._setupProxy,i("app-popup",{attrs:{position:"bottom-right",region:"top-left",width:320,focused:s.viewStateStore.focused},on:{close:function(e){return s.viewStateStore.togglePopup(!1)}},nativeOn:{click:function(e){return s.viewStateStore.focus()}}},[i("app-view-switch-dynamic",{attrs:{"order-key":null==(t=null==(e=s.viewStateStore)?void 0:e.activeView)?void 0:t.order},on:{afterTransition:s.checkSiteBlockerGroupViewOpen}},[s.groupsViewActive?i("site-blocker-groups"):s._e(),s.websitesViewActive?i("site-blocker-websites"):s._e()],1)],1)}),[],!1,null,"c9f31be7").exports;export{J as default};