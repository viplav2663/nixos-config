import{n as t,O as e,e as n,P as i}from"./icon-alert--q0yLTMi.js";import{_ as s}from"./icon-next-B4hjdiAA.js";import{_ as a}from"./arrow-Be8MuPJi.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";const o=t({name:"TourFeature",props:{onCreated:{type:Function,default:()=>{}},onDestroyed:{type:Function,default:()=>{}},maskDefinitions:{type:Array,default:()=>[]},elementReadyEvent:{type:String,default:""},elementReadyCheck:{type:Function,default:()=>!0},heading:{type:String,default:""},subheading:{type:String,default:""},component:{type:Function,default:()=>{}},buttonText:{type:String,default:"Next"},showAppSelector:{type:String,default:""},maskBorderRadius:{type:Number,default:7},alignCta:{type:String,default:""},updateMaskEvents:{type:String,default:""},arrow:{type:String,default:""}},data:()=>({masksDimensions:[],maskWrapperDimensions:{},maskReady:!1}),computed:{maskPadding(){return this.maskDefinitions.map((t=>t.padding))},maskTargetElements(){return this.maskDefinitions.map((t=>t.targetElements))},directions(){return this.arrow.split("-")},ctaStyle(){return{"justify-content":"below"===this.directions[0]?"flex-end":"flex-start"}},containerStyle(){if(!Object.keys(this.maskWrapperDimensions).length)return{};const{height:t,width:e,x:n,y:i,overlayOffsetX:s}=this.maskWrapperDimensions;let a="auto",o="auto",r="auto",d="auto";const l=["right","left"].includes(this.directions[0]),h=["above","below"].includes(this.directions[0]);let m=l?e/2:0;return this.directions.includes("right")?o=Math.max(window.innerWidth-(n+m)-s,50)+"px":this.directions.includes("left")&&(d=Math.max(n+e-m,50)+"px"),m=h?t/2:0,this.directions.includes("above")?(a=Math.max(i+t-m,50)+"px","above"===this.directions[0]&&(r=0)):this.directions.includes("below")&&(r=Math.max(window.innerHeight-(i+m),50)+"px","below"===this.directions[0]&&(a=0)),"start"===this.alignCta?(a=h?"90px":a,o=l?"auto":o,r=h?"auto":r,d=l?"90px":d):"end"===this.alignCta&&(a=h?"auto":a,o=l?"90px":o,r=h?"90px":r,d=l?"auto":d),{"justify-content":"above"===this.directions[0]?"flex-end":"flex-start","flex-direction":["above","below"].includes(this.directions[0])?"column":"row",top:a,right:o,bottom:r,left:d}},paddingList(){return this.maskPadding.map((t=>this.parsePadding(t)))}},mounted(){this.elementReadyCheck()?this.onElementReady():this.elementReadyEvent?m.on(this.elementReadyEvent,this.onElementReadyEvent):this.onElementReady(),window.addEventListener("keyup",this.handleKey)},created(){this.debouncedResizeFn=e((()=>{this.updateContainers()}),200),window.addEventListener("resize",this.debouncedResizeFn),this.onCreated()},destroyed(){this.toggleAppsVisibility(!1),this.elementReadyEvent&&m.off(this.elementReadyEvent,this.onElementReadyEvent),this.updateMaskEvents&&m.off(this.updateMaskEvents,this.updateContainers),m.off("metrics:resize",this.updateContainers),n.$on(["devPanelToggled","globalEvent:window:resize"],this.updateContainers),window.removeEventListener("keyup",this.handleKey),window.removeEventListener("resize",this.debouncedResizeFn),this.onDestroyed()},methods:{handleKey(t){"Enter"===t.code&&this.$emit("next")},onElementReadyEvent(){this.elementReadyCheck()&&(m.off(this.elementReadyEvent,this.onElementReadyEvent),this.onElementReady())},onElementReady(){this.updateMaskEvents&&m.on(this.updateMaskEvents,this.updateContainers),m.on("baseMetric:updated",this.updateContainers),n.$off(["devPanelToggled","globalEvent:window:resize"],this.updateContainers),this.toggleAppsVisibility(!0),this.updateContainers(),this.$emit("maskReady")},updateContainers(){i().then((()=>{this.getMaskWrapperDimensions(),this.applyMask()}))},toggleAppsVisibility(t){m.widgetManager[t?"addAppExemption":"removeAppExemption"](this.showAppSelector||this.maskTargetElements.join(","),"modalContainer")},getShowAppTargetElements(){return document.querySelectorAll(this.showAppSelector||this.maskTargetElements.join(","))},getMaskWrapperDimensions(){const t=document.querySelectorAll(this.maskTargetElements.join(","));t.length&&(this.maskWrapperDimensions=this.getContainerDimensions(t,this.parsePadding([60])))},applyMask(){const t=this.maskTargetElements;for(let[e,n]of t.entries()){const t=document.querySelectorAll(n);if(!t.length)return;this.masksDimensions[e]=this.getContainerDimensions(t,this.paddingList[e])}this.$emit("updateMaskDimensions",this.masksDimensions),this.maskReady=!0},parsePadding(t){switch(t.length||t.push(0),t.length){case 1:return{top:t[0],right:t[0],bottom:t[0],left:t[0]};case 2:return{top:t[0],right:t[1],bottom:t[0],left:t[1]};case 3:return{top:t[0],right:t[1],bottom:t[2],left:t[1]};case 4:return{top:t[0],right:t[1],bottom:t[2],left:t[3]}}},getContainerDimensions(t,e){var n;const i=null==(n=document.querySelector(".tour"))?void 0:n.getBoundingClientRect().x;let s=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=0,r=0;for(const d of t){const{left:t,top:e,right:n,bottom:i}=d.getBoundingClientRect();t<s&&(s=t),e<a&&(a=e),n>o&&(o=n),i>r&&(r=i)}return{x:s-i-e.left,y:a-e.top,width:o-s+e.left+e.right,height:r-a+e.top+e.bottom,borderRadius:this.maskBorderRadius,overlayOffsetX:i}}}},(function(){var t=this,e=t._self._c;return e("div",[e("transition",{attrs:{name:"fade"}},[t.maskReady?e("div",{staticClass:"tour-feature",style:t.containerStyle,attrs:{"data-test":"feature"}},[e("div",{staticClass:"cta",style:t.ctaStyle},[t.heading?e("div",{staticClass:"heading"},[t._v(t._s(t.heading))]):t._e(),t.subheading?e("div",{staticClass:"subheading",domProps:{innerHTML:t._s(t.subheading)}}):t._e(),t.component?e(t.component,{tag:"component",on:{next:function(e){return t.$emit("next")}}}):t._e(),t.buttonText?e("div",{staticClass:"button dash-button",attrs:{"data-test":"next"},on:{click:function(e){return t.$emit("next")}}},[t._v(t._s(t.buttonText)+" "),e("inline-svg",{staticClass:"icon icon-next",attrs:{src:s}})],1):t._e()],1),e("div",{staticClass:"arrow",class:t.arrow},[e("inline-svg",{staticClass:"icon-arrow",attrs:{src:a}})],1)]):t._e()])],1)}),[],!1,null,"c08a3d55").exports;export{o as default};