const t={data:()=>({componentsMounted:{}}),unreactive:()=>({uid:m.utils.shortId()}),beforeCreate(){const t=this.$options.components;Object.keys(t).forEach((e=>{const o=t[e];"function"==typeof o&&(t[e]=function(){this.$set(this.componentsMounted,e,!1);const t=`${e}:${this.uid}:mounted`,n=()=>this.componentsMounted[e]=!0;return this.$e.$once(t,n),o(arguments).then((o=>{const i=o.default;return i&&i.doNotWaitForMount&&(this.$delete(this.componentsMounted,e),this.$e.$off(t,n)),o}))}.bind(this))}))},created(){this.$e.$on("widgets:timeoutExceeded",this.onWidgetTimeout)},mounted(){if(Object.keys(this.componentsMounted).length){const t=this.$watch("componentsMounted",(e=>{Object.values(e).every((t=>t))&&(this.onAllComponentsMounted(),t())}),{deep:!0,immediate:!0})}else this.onAllComponentsMounted()},destroyed(){this.stopListeningToWidgetTimeout()},methods:{stopListeningToWidgetTimeout(){this.$e.$off("widgets:timeoutExceeded",this.onWidgetTimeout)},getContextUid(){return this.$vnode&&this.$vnode.context&&this.$vnode.context.uid||""},onAllComponentsMounted(){this.onAllComponentsMountedOverride?this.onAllComponentsMountedOverride():this.widgetId?m.widgetManager.appReady(this.widgetId):this.emitComponentMounted(),this.stopListeningToWidgetTimeout()},emitComponentMounted(){this.$e.$emit(`${this.$options.name}:${this.getContextUid()}:mounted`)},onWidgetTimeout(){const t=Object.keys(this.componentsMounted).filter((t=>!this.componentsMounted[t]));t.length&&console.warn(`${this.$options.name} is awaiting ${t.join(", ")} to mount.`)}}};export{t as a};