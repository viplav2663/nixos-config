import{S as t}from"./SmoothReflow-Du5fECCq.js";import{_ as e}from"./icon-profile-B_XWyuTb.js";import{_ as a}from"./icon-close-BUGl_M7j.js";import{n as s}from"./icon-alert--q0yLTMi.js";import"./allComponentsMounted-C3UsG_cA.js";import"./localStorage-4iHdj-SC.js";import"./preload-helper-DmNsytk6.js";import"./string-GDe0WbEj.js";const i=s({name:"SafariAccount",components:{SmoothReflow:t},data(){return{currentView:this.VIEWS.HIDDEN,name:m.models.customization.get("displayname"),email:localStorage.getItem("email")||""}},unreactive:()=>({deleting:!1,VIEWS:{HIDDEN:0,DELETE:1,CONFIRM:2,ERROR:3,ERROR_PLUS:4}}),mounted(){m.widgetManager.hideApps()},destroyed(){m.widgetManager.showApps()},methods:{async deleteAccount(){if(!this.deleting)try{this.deleting=!0,await this.$xhr.delete("/user"),m.utils.clearStorage().finally((function(){m.$e.sendCrossTabMessage("reload"),window.location.reload()}))}catch(t){console.error(t),this.currentView=this.VIEWS.ERROR}finally{this.deleting=!1}},close(){m.trigger("modal:close")}}},(function(){var t=this,s=t._self._c;return s("div",[s("div",{staticClass:"overlay"},[s("transition",{attrs:{name:"slide-fade"}},[s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.close,expression:"close"}],staticClass:"app light light-full modal",attrs:{"data-test":"safari-account"}},[s("div",{staticClass:"safari-account"},[s("h2",[s("inline-svg",{staticClass:"icon",attrs:{src:e}}),t._v(" Profile ")],1),s("div",{staticClass:"fake-field"},[s("div",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"value"},[t._v(t._s(t.name))])]),s("div",{staticClass:"fake-field"},[s("div",{staticClass:"label"},[t._v("Email")]),s("div",{staticClass:"value"},[t._v(t._s(t.email))])]),s("div",{staticClass:"section-title",attrs:{"data-test":"delete-account"},on:{click:function(e){t.currentView=t.VIEWS.DELETE}}},[t._v("Delete your Momentum account")]),s("smooth-reflow",{attrs:{"hide-overflow":!0,"transition-group":!0}},[t.currentView===t.VIEWS.DELETE?s("div",{key:t.VIEWS.DELETE,staticClass:"card-delete"},[s("p",{staticClass:"warning"},[t._v("Your account and all of its data will be permanently deleted.")]),s("button",{staticClass:"button button-error",attrs:{"data-test":"delete-account-confirm"},on:{click:function(e){t.currentView=t.$plus?t.VIEWS.ERROR_PLUS:t.VIEWS.CONFIRM}}},[t._v("Delete account")])]):t.currentView===t.VIEWS.CONFIRM?s("div",{key:t.VIEWS.CONFIRM,staticClass:"card-delete"},[s("p",{staticClass:"warning"},[t._v("Are you sure you want to delete your account?")]),s("p",[t._v("You will be logged out of your account and lose your data forever.")]),s("button",{staticClass:"button button-error",attrs:{"data-test":"delete-account-confirm-confirm"},on:{click:t.deleteAccount}},[t._v("Yes, proceed")]),s("button",{staticClass:"button button-neutral",on:{click:function(e){t.currentView=t.VIEWS.DELETE}}},[t._v("No, I've changed my mind")])]):t.currentView===t.VIEWS.ERROR?s("div",{key:t.VIEWS.ERROR,staticClass:"card-delete"},[s("p",{staticClass:"warning"},[t._v("There was an issue deleting your account. Please "),s("span",{staticClass:"try-again",on:{click:function(e){t.currentView=t.VIEWS.CONFIRM}}},[t._v("try again")]),t._v(" or "),s("a",{attrs:{target:"_blank",href:"http://momentumdash.com/contact",title:"help@momentumdash.com"}},[t._v("contact us")]),t._v(" for assistance.")])]):t.currentView===t.VIEWS.ERROR_PLUS?s("div",{key:t.VIEWS.ERROR_PLUS,staticClass:"card-delete"},[s("p",{staticClass:"warning"},[t._v("Please cancel your Momentum Plus subscription first. "),s("a",{attrs:{href:"https://support.apple.com/en-ca/HT202039",target:"_blank"}},[t._v("Here's how")])])]):t._e()])],1),s("span",{staticClass:"icon-wrapper hide",on:{click:t.close}},[s("inline-svg",{staticClass:"icon icon-hide",attrs:{src:a}})],1)])])],1)])}),[],!1,null,"8e9dfcb0").exports;export{i as default};